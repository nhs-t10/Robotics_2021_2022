<!DOCTYPE html>
<html>

<head>
    <title>Dashboard</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <script>
        var mouseX = 0, mouseY = 0, gridSize = Math.max(window.innerHeight, window.innerWidth) / 16, widgetsParent = undefined;

        var widgetsReg = {};

        var fields = [];

        var configGlobals = {};

        var widgetTypes = {
            "none": {
                init: function (parent) { parent.innerHTML = ""; },
                reset: function () { },
                ondata: function (data, parent) { }
            },
            "local.fullscreenbutton": {
                init: function(parent) {
                    var button = document.createElement("button");
                    button.setAttribute("style", `height:100%;border:0;margin:0.5em;background:var(--widget-settings-color)`);
                    button.addEventListener("click", function() {
                        if (document.fullscreenElement) {
                            document.exitFullscreen();
                            button.style.background = `var(--widget-settings-color)`;
                        } else {
                            document.documentElement.requestFullscreen();
                            button.style.background = `var(--close-widget-color)`;
                        }
                    });
                    parent.appendChild(button);
                },
                reset: function() {},
                ondata: function() {}
            },
            "meta.recordandreplay": {
                init: function (parent, state) {
                    state.historyBuffer = [];

                    var ICON_EJECT = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 0,1 h 1 v -0.25 h -1 z M 0 0.5 L 0.5 0 L 1 0.5 Z'></svg>";
                    var ICON_RECORD = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 1,0.5 A 0.5,0.5 0 0 1 0.5,1 0.5,0.5 0 0 1 0,0.5 0.5,0.5 0 0 1 0.5,0 0.5,0.5 0 0 1 1,0.5 Z'></svg>";
                    var ICON_STOP_RECORD = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 0,0 H 1 V 1 H -1 Z'></svg>";
                    var ICON_PLAY = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 0,0 L 1 0.5 L 0 1 Z'></svg>";
                    var ICON_PAUSE = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 0.0,0 h 0.35 V 1 h -0.35 z M 1 0 h -0.35 V 1 h 0.35 z'></svg>";
                    var ICON_PAUSE = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 0.0,0 h 0.35 V 1 h -0.35 z M 1 0 h -0.35 V 1 h 0.35 z'></svg>";
                    var ICON_DL = "<svg width='1' height='1' viewBox='0 0 1 1'><path d='M 0.42257158,0 V 0.70668617 L 0.1419469,0.42606148 0.03360137,0.53440702 0.3908488,0.89165445 h 4.8803e-4 L 0.49919434,0.99999997 0.60753986,0.89165445 0.96478729,0.53440702 0.85644175,0.42606148 0.57581708,0.70668617 V 0 Z'></svg>";

                    parent.classList.add("widget--record");
                    var buttonContainer = document.createElement("nav");
                    parent.appendChild(buttonContainer);

                    var buttonRecord = document.createElement("button");
                    buttonRecord.classList.add("recorder");
                    buttonRecord.addEventListener("click", clickRecordButton);
                    function clickRecordButton() {
                        state.recording = ((state.recording || 0) + 1) % 3;

                        if (state.recording == 0) {
                            reportStopRecordPlayback();
                            state.historyBuffer = [];
                            if (state.dataScrubberPath) state.dataScrubberPath.setAttribute("d", "");
                        }

                        if (state.recording == 2) {
                            reportStartRecordPlayback();
                            state.currentFrame = 1;
                            scrubTo(0);
                            dataScrubber.setAttribute("aria-valuemin", 0);
                            dataScrubber.setAttribute("aria-valuemax", state.historyBuffer.length - 1);
                            dataScrubber.setAttribute("step", 1);
                        }

                        updateIcons();
                    }
                    buttonContainer.appendChild(buttonRecord);

                    var buttonPlaypause = document.createElement("button");
                    buttonPlaypause.classList.add("play-pause");
                    buttonPlaypause.addEventListener("click", clickPlaypauseButton);
                    function clickPlaypauseButton() {
                        if (state.recording == 2) {
                            state.playing = !state.playing;
                            if (state.playing) {
                                if (state.currentFrame === undefined) scrubTo(0);

                                var dsow = dataScrubber.offsetWidth;

                                function playNextFrame() {
                                    if (!state.playing) return;

                                    //if it's ended, loop
                                    if (state.currentFrame + 1 == state.historyBuffer.length) {
                                        resetWidgets();
                                        state.currentFrame = 0;
                                    }

                                    var currentTime = state.historyBuffer[state.currentFrame].time;
                                    var nextTime = state.historyBuffer[state.currentFrame + 1].time;
                                    var tDelta = Math.abs(nextTime - currentTime);

                                    dispatchData(state.historyBuffer[state.currentFrame]);
                                    state.currentFrame++;

                                    var scrubberPx = ((state.currentFrame + (state.historyBuffer.length % 2) / 2) / state.historyBuffer.length) * dsow;
                                    dataScrubberCurrentTimeIndicator.style.transform = `translateX(${scrubberPx}px)`;

                                    dataScrubber.setAttribute("aria-valuenow", state.currentFrame);

                                    setTimeout(playNextFrame, tDelta);
                                }
                                playNextFrame();
                            }
                        }
                        updateIcons();
                    }
                    buttonContainer.appendChild(buttonPlaypause);

                    var buttonDownload = document.createElement("button");
                    buttonDownload.classList.add("download");
                    buttonContainer.appendChild(buttonDownload);
                    buttonDownload.innerHTML = ICON_DL;
                    buttonDownload.addEventListener("click", clickDownloadButton);
                    function clickDownloadButton() {
                        var flattened = state.historyBuffer.map(x => flattenObj(x));

                        var keys = [];
                        for (var i = 0; i < flattened.length; i++) {
                            for (var key in flattened[i]) {
                                if (!keys.includes(key)) keys.push(key);
                            }
                        }

                        var csvHeader = keys.map(x => csvEscape(x)).join(",");
                        var rows = [csvHeader];
                        for (var i = 0; i < flattened.length; i++) {
                            var row = [];
                            for (var j = 0; j < keys.length; j++) {
                                if (flattened[i][keys[j]] !== undefined) row.push(csvEscape(flattened[i][keys[j]]));
                                else row.push("");
                            }
                            rows.push(row.join(","));
                        }

                        var csvFile = rows.join("\n");
                        var csvBlob = new Blob([csvFile], {type: "text/csv"})
                        downloadURL(window.URL.createObjectURL(csvBlob), "recording-" + new Date().toISOString() + ".csv");
                    }

                    function updateIcons() {
                        buttonRecord.setAttribute("red-icon", state.recording == 1);
                        buttonPlaypause.setAttribute("greyed", state.recording != 2);
                        buttonDownload.setAttribute("greyed", state.recording != 2);

                        if (state.recording == 2) buttonRecord.innerHTML = ICON_EJECT;
                        else buttonRecord.innerHTML = ICON_RECORD;

                        if (state.playing) buttonPlaypause.innerHTML = ICON_PAUSE;
                        else buttonPlaypause.innerHTML = ICON_PLAY;

                        if (state.recording != 2) {
                            dataScrubberHoverCursor.style.opacity = 0;
                            dataScrubberCurrentTimeIndicator.style.opacity = 0;
                        } else {
                            dataScrubberHoverCursor.style.opacity = 0.4;
                            dataScrubberCurrentTimeIndicator.style.opacity = 1;
                        }
                    }


                    var dataScrubber = document.createElement("div");
                    dataScrubber.setAttribute("role", "slider");
                    dataScrubber.setAttribute("tabindex", "0");

                    var dataScrubberPointsSvg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    dataScrubberPointsSvg.style.pointerEvents = "none";
                    dataScrubberPointsSvg.style.width = "100%";
                    dataScrubberPointsSvg.style.height = "100%";

                    var dataScrubberPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    dataScrubberPath.style.fill = "var(--graph-label)";
                    dataScrubberPointsSvg.appendChild(dataScrubberPath);
                    state.dataScrubberPath = dataScrubberPath;

                    var dataScrubberHoverCursor = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    dataScrubberHoverCursor.style.fill = "var(--widget-text-color)";
                    dataScrubberPointsSvg.appendChild(dataScrubberHoverCursor);
                    dataScrubberHoverCursor.setAttribute("d", "M0 0V1000h-1V0Z");
                    dataScrubberHoverCursor.style.opacity = "0";
                    dataScrubber.addEventListener("mousemove", function (e) {
                        if (state.recording == 2) {
                            var rawX = e.clientX - dataScrubber.offsetLeft;
                            var normX = rawX / dataScrubber.offsetWidth;
                            var roundX = Math.round(normX * state.historyBuffer.length) + (state.historyBuffer.length % 2) / 2;
                            var finalX = (roundX / state.historyBuffer.length) * dataScrubber.offsetWidth;
                            dataScrubberHoverCursor.style.transform = `translateX(${finalX}px)`;
                        }
                    });
                    dataScrubber.addEventListener("mouseenter", function() {
                        dataScrubberHoverCursor.style.opacity = 0.4;
                    });
                    dataScrubber.addEventListener("mouseleave", function() {
                        dataScrubberHoverCursor.style.opacity = 0;
                    });

                    var dataScrubberCurrentTimeIndicator = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    dataScrubberCurrentTimeIndicator.style.fill = "var(--data-red)";
                    dataScrubberPointsSvg.appendChild(dataScrubberCurrentTimeIndicator);
                    dataScrubberCurrentTimeIndicator.setAttribute("d", "M0 0V1000h-1V0Z");
                    dataScrubber.addEventListener("click", function (e) {
                        if (state.recording == 2) {
                            var rawX = e.clientX - dataScrubber.offsetLeft;
                            var normX = rawX / dataScrubber.offsetWidth;
                            var roundX = Math.round(normX * state.historyBuffer.length);
                            scrubTo(roundX);
                        }
                    });
                    dataScrubber.addEventListener("keydown", function (e) {
                        if (state.recording == 2) {
                            console.log(e.key);
                            
                            if (e.key == "ArrowRight") {
                                scrubTo(state.currentFrame + 1);
                            } else if (e.key == "ArrowLeft") {
                                scrubTo(state.currentFrame - 1);
                            } else if(!isNaN(+e.key)) {
                                var parseNum = +e.key;
                                console.log("pNum", parseNum);
                                var frame = Math.round((parseNum / 10) * state.historyBuffer.length);
                                console.log(frame);
                                scrubTo(frame);
                            }
                        }
                    });


                    function scrubTo(frame) {
                        var oldFrame = state.currentFrame;
                        
                        frame = (frame + state.historyBuffer.length) % state.historyBuffer.length;
                        state.currentFrame = frame;


                        var scrubberPx = ((frame + (state.historyBuffer.length % 2) / 2) / state.historyBuffer.length) * dataScrubber.offsetWidth;
                        dataScrubberCurrentTimeIndicator.style.transform = `translateX(${scrubberPx}px)`;

                        if(frame > oldFrame) {
                            for (var i = oldFrame; i <= frame; i++) {
                                dispatchData(state.historyBuffer[i]);
                            }
                        } else if(frame < oldFrame) {   
                            resetWidgets();
                            for (var i = 0; i <= frame; i++) {
                                dispatchData(state.historyBuffer[i]);
                            }
                        }
                        
                        dataScrubber.setAttribute("aria-valuenow", frame);
                    }

                    dataScrubber.appendChild(dataScrubberPointsSvg);
                    parent.appendChild(dataScrubber);
                    updateIcons();
                    
                    parent.setAttribute("tabIndex", 0);
                    parent.addEventListener("keydown", function(e) {
                        if(e.key == " " || e.key == "Enter") e.preventDefault();
                        
                        if(e.key == " ") {
                            if(state.recording == 2) clickPlaypauseButton();
                            else clickRecordButton();
                        } else if(e.key == "Delete") {
                            if(state.recording == 2) {
                                clickRecordButton();
                            }
                        } else if(e.key == "D") {
                            clickDownloadButton();
                        } else {
                            var cloneEvent = new KeyboardEvent("keydown", {
                                key: e.key,
                                keyCode: e.keyCode,
                                location: e.location,
                                code: e.code,
                                ctrlKey: e.ctrlKey,
                                shiftKey: e.shiftKey,
                                altKey: e.altKey,
                                metaKey: e.metaKey,
                                repeat: e.repeat,
                                isComposing: e.isComposing,
                                charCode: e.charCode,
                                which: e.which
                            });
                            dataScrubber.dispatchEvent(cloneEvent);
                        }
                    })

                },
                reset: function (parent, state) {
                    if (state.recording != 2) {
                        state.historyBuffer = [];
                        if (state.dataScrubberPath) state.dataScrubberPath.setAttribute("d", "");
                    }
                },
                onbeforedelete: function () {
                    reportStopRecordPlayback();
                    resetWidgets();
                },
                ondata: function (data, parent, state, config) {
                    if (state.recording == 1) {
                        state.historyBuffer.push(data);

                        if (!state.dataScrubberTotalWidth) state.dataScrubberTotalWidth = state.dataScrubberPath.parentElement.clientWidth;
                        var dataScrubberTotalWidth = state.dataScrubberTotalWidth;

                        var dataScrubberTotalHeight = state.dataScrubberTotalHeight;
                        if (!state.dataScrubberTotalHeight) {
                            var h = state.dataScrubberPath.parentElement.clientHeight;
                            if (!state.smallDataScrubberHeight) state.smallDataScrubberHeight = h;
                            if (h > state.smallDataScrubberHeight) state.dataScrubberTotalHeight = h;

                            dataScrubberTotalHeight = h;
                        }


                        var dataScrubberPathCode = "";

                        var renderedPathPoints = Math.min(Math.floor(state.dataScrubberTotalWidth / 4), state.historyBuffer.length);
                        renderedPathPoints += state.historyBuffer.length % 4;
                        for (var i = 0; i < renderedPathPoints; i++) {
                            var x = i + (state.historyBuffer.length % 2) / 2;
                            dataScrubberPathCode += "M" + (dataScrubberTotalWidth * (x / renderedPathPoints)) + " " + 1000;

                            var barHeight = -1000;

                            dataScrubberPathCode += `v ${barHeight} h 1 v ${barHeight} z`;
                        }

                        state.dataScrubberPath.setAttribute("d", dataScrubberPathCode);
                    }
                }
            },
            "buildhistory.profile": {
                init: function (parent, state, config, box) {
                    var title = document.createElement("h2");
                    title.setAttribute("style", 'margin:0');
                    var image = document.createElement("img");
                    image.setAttribute("style", 'margin-right:0.25em;border-radius:2em;width:4em;height:4em');
                    1
                    var toprow = document.createElement("div");
                    toprow.setAttribute("style", 'display:flex;align-items:center');

                    toprow.appendChild(image);
                    toprow.appendChild(title);

                    var description = document.createElement("p");

                    parent.appendChild(toprow);
                    parent.appendChild(description);

                    var xhr = new XMLHttpRequest();
                    xhr.onload = function () {
                        var buildHistory = JSON.parse(xhr.responseText);
                        title.textContent = buildHistory.w3w;
                        image.src = buildHistory.img;
                        description.textContent = buildHistory.hash;
                    }
                    xhr.open("GET", "/build-history");
                    xhr.send();
                },
                reset: function () { },
                ondata: function (data, parent, state, config) {

                },
                config: []
            },
            "autoauto.statelayout": {
                init: function (parent, state, config, box) {

                    var statepathlist = document.createElement("ul");
                    statepathlist.classList.add("widget--autoauto-state-layout--list");
                    parent.appendChild(statepathlist);
                    state.list = statepathlist;
                },
                reset: function (parent, state) {
                    if (state.list) {
                        while (state.list.children[0]) {
                            state.list.removeChild(state.list.children[0]);
                        }
                    }
                    state.statepathListInitiated = false;
                },
                ondata: function (data, parent, state, config) {
                    if (!state.statepathListInitiated) {
                        if (!data.autoautoProgram) return false;

                        state.statepaths = {};

                        var programOutline = data.autoautoProgram;

                        //it's a full program json wow
                        if (programOutline.type === "Program") programOutline = programOutline.statepaths.map(x => [x.label.value, x.statepath.states.length]);
                        else programOutline = Object.entries(programOutline);

                        programOutline.forEach(x => {
                            state.statepaths[x[0]] = [];

                            var statepathListItem = document.createElement("li");
                            var statepathNameHeader = document.createElement("h2");
                            statepathNameHeader.textContent = x[0];

                            var stateList = document.createElement("ol");

                            statepathListItem.appendChild(statepathNameHeader);
                            statepathListItem.appendChild(stateList);

                            state.list.appendChild(statepathListItem);

                            for (var i = 0; i < x[1]; i++) {
                                (function (i) {
                                    var stateButtonLi = document.createElement("li");
                                    var button = document.createElement("button");

                                    state.statepaths[x[0]].push(stateButtonLi);

                                    stateButtonLi.appendChild(button);
                                    button.textContent = i;
                                    button.addEventListener("click", function () {
                                        sendCommand("auauss", x[0], i);
                                    });

                                    stateList.appendChild(stateButtonLi);
                                })(i);
                            }
                        });

                        state.statepathListInitiated = true;
                    }
                    if (state.selectedButton) state.selectedButton.classList.remove("selected");
                    if (state.statepaths[data.fields.__statepathName]) {
                        var statepathsButtons = state.statepaths[data.fields.__statepathName];

                        if (statepathsButtons[+data.fields.__stateNumber]) {
                            state.selectedButton = statepathsButtons[+data.fields.__stateNumber];
                            state.selectedButton.classList.add("selected");
                        }
                    }
                }
            },
            "autoauto.dataquantityconfig": {
                init: function () {

                },
                ondata: function (data, parent, state, config) {
                    //only send a request when it changes
                    if (config.dataTransferAmount != configGlobals.autoautoDataTransferAmount) {
                        configGlobals.autoautoDataTransferAmount = config.dataTransferAmount;
                        var commands = {
                            "Don't send data": "auauds",
                            "Send all data": "auaus",
                            "Send simplified program outline": "auaubs"
                        };
                        if (commands[config.dataTransferAmount]) sendCommand(commands[config.dataTransferAmount], configGlobals.streamID);
                    }
                },
                reset: function () { },
                config: [
                    {
                        name: "dataTransferAmount",
                        type: "select",
                        value: ["Don't send data", "Send all data", "Send simplified program outline"]
                    }
                ]
            },
            "meta.datarateconfig": {
                init: function () {

                },
                ondata: function (data, parent, state, config) {
                    //only send a request when it changes
                    if (config.sendsPerSecond != configGlobals.sendsPerSecond) {
                        configGlobals.sendsPerSecond = config.sendsPerSecond;
                        sendCommand("sps", configGlobals.streamID, config.sendsPerSecond);
                    }
                },
                reset: function () { },
                config: [
                    {
                        name: "sendsPerSecond",
                        type: "number",
                        default: 30
                    }
                ]
            },
            "meta.theme": {
                init: function (parent) {
                    var select = document.createElement("select");
                    var themes = ["dark", "light"];
                    var current = localStorage.getItem("theme");

                    for (var i = 0; i < themes.length; i++) {
                        var opt = document.createElement("option");
                        if (themes[i] == current) opt.selected = true;
                        opt.textContent = themes[i];
                        select.appendChild(opt);
                    }

                    select.addEventListener("change", function () {
                        localStorage.setItem("theme", themes[select.selectedIndex]);
                        document.body.classList.remove("dark-theme");
                        document.body.classList.remove("light-theme");
                        document.body.classList.add(themes[select.selectedIndex] + "-theme");
                    });

                    parent.appendChild(select);
                },
                reset: function () { },
                ondata: function (data, parent) { }
            },
            "debug.alldata": {
                init: function (parent, state) {
                    var pre = document.createElement("pre");
                    state.pre = pre;
                    parent.appendChild(pre);
                },
                reset: function (parent, state) {
                    if (state.pre) state.pre.textContent = "";
                    state.lastScroll = 0;
                    parent.scrollTop = 0;
                },
                ondata: function (data, parent, state) {
                    var scrolledToBottom = parent.scrollHeight - Math.abs(parent.scrollTop) === parent.clientHeight;

                    //override for when the scroll changes on hover
                    if (state.lastScrolledToBottom && state.lastScroll == parent.scrollTop) scrolledToBottom = true;

                    state.pre.appendChild(document.createTextNode(JSON.stringify(data) + "\n"));

                    if (scrolledToBottom) parent.scrollTop = parent.scrollHeight - parent.clientHeight;

                    state.lastScroll = parent.scrollTop;
                    state.lastScrolledToBottom = scrolledToBottom;
                }
            },

            "chart.line": {
                init: function (parent, state, config, box) {
                    //use object.assign to avoid mutation of original box
                    state.box = {};
                    Object.assign(state.box, box);

                    state.datapoints = [];

                    var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    svg.classList.add("widget--line-chart");

                    svg.setAttribute("height", box.height * gridSize);
                    svg.setAttribute("width", box.width * gridSize);

                    //scale up for a crisper view
                    state.box.height *= 2 * gridSize;
                    state.box.width *= 2 * gridSize;

                    svg.setAttribute("viewBox", `0 0 ${state.box.width} ${state.box.height}`);
                    svg.setAttribute("preserveAspectRatio", "xMidYMid meet");
                    svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");

                    var path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    path.classList.add("widget--line-chart--stroke-line");

                    var fillPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    fillPath.classList.add("widget--line-chart--fill-line");

                    //caption lines
                    for (var i = 0; i <= 4; i++) {
                        var captionLine = document.createElementNS("http://www.w3.org/2000/svg", "path");
                        captionLine.classList.add("widget--line-chart--caption-line");
                        captionLine.setAttribute("d", "M0," + (state.box.height * i / 4) + "H" + state.box.width);
                        svg.appendChild(captionLine);
                    }

                    state.captions = [];
                    //captions themselves. They go after so that they'll overlay the lines.
                    for (var i = 0; i <= 4; i++) {
                        //use IEFE so that `i` is preserved in each
                        (function (i) {
                            var caption = document.createElementNS("http://www.w3.org/2000/svg", "text");
                            caption.classList.add("widget--line-chart--caption");
                            caption.setAttribute("x", 0);
                            caption.setAttribute("y", (state.box.height * i / 4) - 6);


                            state.captions.push(function (max, min) {
                                var range = max - min;
                                caption.textContent = (min + (range * (1 - i / 4))).toString().substring(0, 5);
                            });

                            svg.appendChild(caption);
                        })(i);
                    }

                    svg.appendChild(fillPath);
                    svg.appendChild(path);


                    state.path = path;
                    state.fill = fillPath;

                    parent.appendChild(svg);
                    parent.classList.add("nopadding");
                    parent.classList.add("nooverflow");
                },
                reset: function (parent, state) {
                    state.datapoints = [];
                    if (state.path) state.path.setAttribute("d", "");
                    if (state.fill) state.fill.setAttribute("d", "");
                },
                ondata: function (data, parent, state, config) {
                    var num = data.fields[config.field];

                    try {
                        num = eval("(x=>" + config.formula + ")")(num);
                    } catch(e) {}

                    state.datapoints.push({
                        x: data.time,
                        y: num
                    });

                    var dataDisplayed = sliceData(state.datapoints, data.time - config.xScaleSeconds * 1000);

                    var line = drawLine(dataDisplayed, state.box, config.xScaleSeconds * 1000);

                    var max = dataDisplayed[0].y;
                    var min = dataDisplayed[0].y;
                    for (var i = 0; i < dataDisplayed.length; i++) {
                        max = Math.max(max, dataDisplayed[i].y);
                        min = Math.min(min, dataDisplayed[i].y);
                    }

                    max = Math.round(max * 1000) / 1000;
                    min = Math.round(min * 1000) / 1000;

                    min = config.yScaleMin || min;
                    max = config.yScaleMax || max;

                    for (var i = 0; i < state.captions.length; i++) {
                        state.captions[i](max, min);
                    }

                    state.path.setAttribute("d", line);
                    state.fill.setAttribute("d", line + "L" + state.box.width + "," + state.box.height + "L" + (0) + "," + (state.box.height) + "Z");
                },
                config: [
                    {
                        name: "field",
                        type: "select",
                        value: "field"
                    },
                    {
                        name: "xScaleSeconds",
                        type: "number",
                        default: 5
                    },
                    {
                        name: "yScaleMin",
                        type: "number",
                        default: 0
                    },
                    {
                        name: "yScaleMax",
                        type: "number",
                        default: 0
                    },
                    {
                        name: "formula",
                        type: "text",
                        default: "x"
                    }

                ]
            },

            "number.single": {
                init: function (parent, state) {
                    state.num = document.createElement("h3");
                    state.caption = document.createElement("span");

                    parent.appendChild(state.caption);
                    parent.appendChild(state.num);

                    parent.classList.add("nopadding");
                    parent.classList.add("nooverflow");
                    parent.classList.add("center");
                },
                reset: function (parent, state) {
                    state.num.textContent = "";
                    state.caption.textContent = "";
                },
                ondata: function (data, parent, state, config) {
                    if (data.fields === undefined) return false;

                    var num = data.fields[config.field];

                    try {
                        num = eval("(x=>" + config.formula + ")")(num);
                    } catch(e) {}

                    var numRounded = config.base10Precision ? (Math.round(num / config.base10Precision) * config.base10Precision).toString() : num.toString();

                    var greaterPart = numRounded.split(".")[0];
                    var lesserPart = numRounded.split(".")[1];
                    //if there's a decimal part...
                    if (greaterPart != numRounded) {
                        var decimalPartRoundingLength = config.base10Precision ? (config.base10Precision.toString().split(".")[1] || "").length : lesserPart.length;
                        numRounded = greaterPart + "." + lesserPart.substring(0, decimalPartRoundingLength);
                    }

                    state.num.textContent = numRounded;
                    state.caption.textContent = config.label;
                },
                config: [
                    {
                        name: "field",
                        type: "select",
                        value: "field"
                    },
                    {
                        name: "label",
                        type: "text",
                        default: ""
                    },
                    {
                        name: "formula",
                        type: "text",
                        default: "x"
                    },
                    {
                        name: "base10Precision",
                        type: "number",
                        default: 0.001
                    }
                ]
            },
            "number.delta": {
                init: function (parent, state) {
                    state.num = document.createElement("h3");
                    var deltaParent = document.createElement("span");

                    state.deltaIcon = document.createElement("span");
                    state.delta = document.createElement("span");
                    state.caption = document.createElement("span");

                    deltaParent.appendChild(state.deltaIcon);
                    deltaParent.appendChild(state.delta);

                    parent.appendChild(state.caption);
                    parent.appendChild(state.num);
                    parent.appendChild(deltaParent);

                    parent.classList.add("nopadding");
                    parent.classList.add("nooverflow");
                    parent.classList.add("center");
                },
                reset: function (parent, state) {
                    state.lastNum = 0;

                    state.delta.textContent = "";
                    state.caption.textContent = "";
                    state.deltaIcon.textContent = "";
                },
                ondata: function (data, parent, state, config) {
                    var num = data.fields[config.field] || 0;

                    try {
                        num = eval("(x=>" + config.formula + ")")(num);
                    } catch(e) {}

                    if (state.lastNum === undefined) state.lastNum = num;

                    var numRounded =config.base10Precision ? (Math.round(num / config.base10Precision) * config.base10Precision).toString() : num.toString();

                    var greaterPart = numRounded.split(".")[0];
                    var lesserPart = numRounded.split(".")[1];
                    //if there's a decimal part...
                    if (greaterPart != numRounded) {
                        var decimalPartRoundingLength = config.base10Precision ? (config.base10Precision.toString().split(".")[1] || "").length : lesserPart.length;
                        numRounded = greaterPart + "." + lesserPart.substring(0, decimalPartRoundingLength);
                    }

                    state.num.textContent = numRounded;

                    var deltaPercent = ((num - state.lastNum) / state.lastNum) * 100;
                    if (deltaPercent > 0) {
                        state.deltaIcon.textContent = "+";
                        state.delta.style.color = "var(--data-green)";
                    } else {
                        state.deltaIcon.textContent = "";
                        state.delta.style.color = "var(--data-red)";
                    }
                    state.delta.textContent = Math.round(deltaPercent) + "%";

                    state.caption.textContent = config.label;

                    state.lastNum = num;
                },
                config: [
                    {
                        name: "field",
                        type: "select",
                        value: "field"
                    },
                    {
                        name: "label",
                        type: "text",
                        default: ""
                    },
                    {
                        name: "formula",
                        type: "text",
                        default: "x"
                    },
                    {
                        name: "base10Precision",
                        type: "number",
                        default: 0.001
                    }
                ]
            },
            "string.stringfield": {
                init: function (parent, state) {
                    state.caption = document.createElement("span");
                    state.field = document.createElement("p");

                    parent.appendChild(state.caption);
                    parent.appendChild(state.field);

                    parent.classList.add("nopadding");
                    parent.classList.add("center");
                },
                reset: function (parent, state) {
                    state.field.textContent = "";
                    state.caption.textContent = "";
                },
                ondata: function (data, parent, state, config) {
                    if (data.fields === undefined) return false;

                    state.field.textContent = data.fields[config.field];
                    state.caption.textContent = config.label;
                },
                config: [
                    {
                        name: "field",
                        type: "select",
                        value: "field"
                    },
                    {
                        name: "label",
                        type: "text",
                        default: ""
                    }
                ]
            },
            "log.autoscroll": {
                init: function (parent, state) {
                    var pre = document.createElement("pre");
                    state.pre = pre;
                    parent.appendChild(pre);
                },
                reset: function (parent, state) {
                    state.pre.textContent = "";
                },
                ondata: function (data, parent, state) {
                    var scrolledToBottom = parent.scrollHeight - Math.abs(parent.scrollTop) === parent.clientHeight;

                    //override for when the scroll changes on hover
                    if (state.lastScrolledToBottom && state.lastScroll == parent.scrollTop) scrolledToBottom = true;

                    if (data.log) state.pre.appendChild(document.createTextNode(data.log + "\n"));

                    if (scrolledToBottom) parent.scrollTop = parent.scrollHeight - parent.clientHeight;

                    state.lastScroll = parent.scrollTop;
                    state.lastScrolledToBottom = scrolledToBottom;
                }
            },
            "log.noautoscroll": {
                init: function (parent, state) {
                    var pre = document.createElement("pre");
                    state.pre = pre;
                    parent.appendChild(pre);
                },
                reset: function (parent, state) {
                    state.pre.textContent = "";
                },
                ondata: function (data, parent, state) {
                    if (data.log) state.pre.appendChild(document.createTextNode(data.log + "\n"));
                }
            },
            "connection.serverlagtime": {
                init: function (parent, state) {
                    state.num = document.createElement("h3");
                    var deltaParent = document.createElement("span");

                    state.deltaIcon = document.createElement("span");
                    state.delta = document.createElement("span");

                    deltaParent.appendChild(state.deltaIcon);
                    deltaParent.appendChild(state.delta);

                    parent.appendChild(state.num);
                    parent.appendChild(deltaParent);

                    parent.classList.add("nopadding");
                    parent.classList.add("nooverflow");
                    parent.classList.add("center");
                },
                reset: function (parent, state) {
                    state.lastConnectionLag = 0;
                    state.delta.textContent = "";
                    state.deltaIcon.textContent = "";
                },
                ondata: function (data, parent, state) {
                    var connectionLag = Date.now() - data.time;

                    if (state.lastConnectionLag === undefined) state.lastConnectionLag = connectionLag;

                    state.num.textContent = connectionLag + "ms";

                    var deltaLag = ((connectionLag - state.lastConnectionLag) / state.lastConnectionLag) * 100;
                    if (deltaLag > 0) {
                        state.deltaIcon.textContent = "+";
                        state.delta.style.color = "var(--data-green)";
                    } else {
                        state.deltaIcon.textContent = "";
                        state.delta.style.color = "var(--data-red)";
                    }
                    state.delta.textContent = Math.round(deltaLag) + "%";

                    state.lastConnectionLag = connectionLag;
                }
            },
            "input.gamepad1": {
                init: function (parent, state) {
                    var svgSrc = `<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" x="0px" y="0px" viewBox="0 0 511.99999 512" xml:space="preserve" id="svg252" sodipodi:docname="Joystick Game Controls Vector.svg" inkscape:version="0.92.4 (5da689c313, 2019-01-14)" width="512" height="512"><metadata id="metadata258"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><defs id="defs256" /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1017" id="namedview254" showgrid="false" inkscape:zoom="0.75009178" inkscape:cx="131.46842" inkscape:cy="155.92237" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="Capa_1" inkscape:snap-smooth-nodes="true" inkscape:snap-intersection-paths="true" inkscape:object-paths="true" inkscape:snap-midpoints="true" inkscape:snap-bbox="true" inkscape:snap-bbox-midpoints="true" inkscape:bbox-paths="true" inkscape:bbox-nodes="true" inkscape:snap-bbox-edge-midpoints="true" inkscape:snap-page="true" /><style type="text/css" id="style2"> .st0{fill:#E9F2FF;} .st2{fill:#89A2B0;} .st3{fill:#CED8DC;} .st4{fill:#D6E9F6;} .st5{fill:#AAC9D6;} .st6{fill:#FAE0D6;} .st7{fill:#EB6777;} .st8{fill:#00C2A2;} .st9{fill:#F8E8A0;} .st10{fill:#FFFFFF;} .st11{fill:#EBBE62;} .st12{fill:#FF6F4C;} .st13{fill:#BAD6E5;} .st14{fill:#2D3130;} .st15{fill:#B1C3C9;} .st16{fill:#6A8693;} .st17{fill:#7FB0C6;}</style><switch id="switch250" transform="translate(0,-692.69995)"> <foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"> </foreignObject> </switch> <g id="Capa_1" transform="rotate(9.2963007,4360.9329,1794.1369)"><g id="g5656" transform="matrix(1.0315332,0,0,1.0315332,-948.80632,499.01779)"><path data-button="left_trigger" style="fill:#d6e9f6" inkscape:connector-curvature="0" id="path33" d="m 770.6,368.4 c 0,0.5 0,0.7 0,0.8 0.1,0.4 -0.1,1.1 0.6,1.1 0.4,0 0.9,-0.2 1.2,-0.4 1,-0.8 1.9,-1.7 2.8,-2.6 11.9,-10.7 25.7,-17.8 41.3,-21.3 5.1,-1.2 10.4,-1.9 15.6,-2.7 12.8,-2.1 25.6,-4.1 38.3,-6.2 6,-1 12,-2 18,-3 0.8,-0.1 1.1,-0.7 0.7,-1.4 -0.5,-0.8 -1.1,-1.5 -1.8,-2.2 -12.9,-13 -28.4,-18.5 -46.7,-15.8 -5.1,0.7 -10.1,1.5 -15.2,2.4 -5.2,0.9 -10.5,1.5 -15.5,2.9 -21.3,5.4 -38,24.2 -39.3,48.4 z" class="st4" /><path data-button="right_trigger" style="fill:#d6e9f6" inkscape:connector-curvature="0" id="path35" d="m 1103.5,272.7 c -2.8,0.1 -5.5,0.2 -8.2,0.7 -8.8,1.5 -17.7,2.7 -26.5,4.3 -17.7,3.2 -30.6,13 -38.8,29 -0.5,1 -0.9,2 -1.3,3.1 -0.3,0.9 0.2,1.6 1.2,1.4 4.6,-0.7 9.2,-1.4 13.7,-2.1 19.7,-3.2 39.4,-6.4 59.1,-9.6 14.9,-2.4 29.6,-1.2 44,3.7 1.1,0.4 2.1,0.7 3.2,1 0.3,0.1 0.7,0 0.9,-0.2 0.1,-0.1 0.1,-0.6 0,-0.8 -0.3,-0.7 -0.6,-1.5 -1,-2.2 -10.1,-18.2 -25.7,-27.3 -46.3,-28.3 z" class="st4" /><path  inkscape:connector-curvature="0" id="path91" d="m 847.4,410.4 c 0.1,2 -0.4,3.8 -1.6,5.4 -2.6,3.6 -5.1,7.3 -7.9,10.9 -3.1,3.9 -7.3,4.7 -11.4,2 -4.4,-2.9 -8.6,-6.1 -12.8,-9.2 -1.7,-1.3 -2.7,-3.1 -3,-5.3 -1.2,-7.4 -2.5,-14.8 -3.6,-22.2 -0.8,-5.7 1.7,-9.1 7.5,-10.2 6.4,-1.2 12.9,-2.3 19.3,-3.2 4.7,-0.7 8.5,2.1 9.5,6.8 0.6,2.8 1,5.7 1.4,8.5 0.8,4.6 1.5,9.1 2.2,13.7 0.2,0.9 0.3,1.9 0.4,2.8 z" class="st1" /><path data-button="dpad_up"  inkscape:connector-curvature="0" id="path93" d="m 844.4,410.5 c -0.1,-0.8 -0.1,-1.6 -0.3,-2.4 -0.8,-4.7 -1.6,-9.4 -2.4,-14.2 -0.4,-2.7 -0.7,-5.4 -1.3,-8 -0.7,-3 -3,-4.7 -6,-4.3 -6.6,1 -13.2,2.1 -19.8,3.3 -3.6,0.7 -5.2,3 -4.6,6.6 1.1,7.3 2.4,14.5 3.5,21.7 0.3,1.8 1.2,3.3 2.7,4.4 3.9,2.8 7.7,5.7 11.7,8.4 3.1,2.1 5.6,1.6 7.9,-1.4 2.5,-3.3 4.9,-6.7 7.3,-10.1 0.8,-1.2 1.4,-2.5 1.3,-4 z" class="st13" /><path  inkscape:connector-curvature="0" id="path95" d="m 890.7,437.1 c 0.1,4.7 -2.1,7.7 -6.7,8.6 -5.2,1.1 -10.4,1.8 -15.6,2.7 -2.2,0.4 -4.4,0.7 -6.6,1 -3,0.5 -5.7,-0.1 -8.1,-2 -2.9,-2.2 -6,-4.3 -8.9,-6.5 -4.6,-3.5 -5.3,-7.7 -2,-12.5 2.7,-3.9 5.6,-7.8 8.4,-11.7 1.7,-2.4 3.9,-3.6 6.7,-4.1 6.6,-1 13.2,-2.3 19.8,-3.3 4.7,-0.7 8.7,2 9.6,6.6 1.2,6.6 2.2,13.2 3.2,19.8 0.1,0.6 0.1,1.1 0.2,1.4 z" class="st1" /><path data-button="dpad_right"  inkscape:connector-curvature="0" id="path97" d="m 887.6,436.1 c -0.3,-1.6 -0.6,-3.8 -1,-6 -0.7,-4.3 -1.3,-8.5 -2.1,-12.7 -0.7,-3.6 -3,-5.4 -6.4,-4.9 -6.6,1 -13.2,2.2 -19.8,3.2 -1.9,0.3 -3.3,1.1 -4.4,2.6 -2.9,4 -5.9,8 -8.7,12 -2.2,3.3 -1.7,5.9 1.4,8.3 3,2.3 6.2,4.5 9.3,6.7 1.7,1.2 3.5,1.5 5.4,1.2 1.9,-0.3 3.8,-0.6 5.7,-0.9 5.2,-0.9 10.4,-1.6 15.6,-2.6 3.9,-0.8 5.2,-2.6 5,-6.9 z" class="st13" /><path  inkscape:connector-curvature="0" id="path99" d="m 804.9,421.3 c 2.7,-0.2 4.8,0.3 6.7,1.7 4,2.9 8.1,5.7 12,8.7 4.2,3.3 4.9,7.7 1.9,12.2 -2.2,3.3 -4.6,6.5 -7,9.7 -1.5,2 -3.4,3.3 -5.9,3.7 -5.2,0.8 -10.4,1.7 -15.6,2.6 -2.4,0.4 -4.7,0.7 -7.1,1.1 -4.6,0.7 -8.7,-1.9 -9.6,-7.2 -1.1,-6.4 -2.2,-12.9 -3.1,-19.4 -0.9,-6 3.1,-9.3 6.8,-9.9 6.6,-1.1 13.2,-2.1 19.8,-3.2 0.6,0.1 1.1,0 1.1,0 z" class="st1" /><path data-button="dpad_left"  inkscape:connector-curvature="0" id="path101" d="m 805.8,424.3 c -1,0.1 -1.4,0.1 -1.9,0.2 -6.3,1 -12.6,1.9 -18.9,3.1 -3.7,0.7 -5.3,3.1 -4.7,7 0.6,4.3 1.4,8.5 2.1,12.8 0.3,1.9 0.5,3.8 0.9,5.7 0.9,4.2 2.9,5.6 7.2,5 1.9,-0.2 3.8,-0.6 5.7,-0.9 5,-0.8 10.1,-1.7 15.1,-2.5 2.4,-0.4 4.1,-1.5 5.4,-3.5 2,-2.9 4.2,-5.7 6.1,-8.6 2.4,-3.5 2,-6.1 -1.4,-8.6 -3.7,-2.8 -7.5,-5.4 -11.2,-8.2 -1.5,-1.1 -3.1,-1.7 -4.4,-1.5 z" class="st13" /><path  inkscape:connector-curvature="0" id="path103" d="m 830.3,491 c -4.3,0 -7.3,-2.3 -8.2,-6.6 -1.3,-6.7 -2.3,-13.5 -3.4,-20.3 -0.3,-2.1 0.3,-4.1 1.6,-5.9 3,-4.2 5.8,-8.4 9,-12.4 3,-3.8 7.4,-4.4 11.5,-1.7 3.7,2.5 7.3,5.2 10.9,7.8 1.9,1.4 3,3.3 3.4,5.6 1.1,6.9 2.4,13.8 3.4,20.8 0.6,4.5 -2,8.5 -6.4,9.3 -6.9,1.3 -13.9,2.2 -20.8,3.3 -0.3,0.1 -0.7,0.1 -1,0.1 z" class="st1" /><path data-button="dpad_down"  inkscape:connector-curvature="0" id="path105" d="m 832,487.9 c 1.7,-0.3 4.1,-0.7 6.4,-1 4.1,-0.7 8.2,-1.2 12.3,-2 3.3,-0.6 5.2,-3 4.8,-6.1 -1,-6.9 -2.3,-13.9 -3.4,-20.8 -0.3,-1.7 -1.3,-2.9 -2.6,-3.9 -3.4,-2.4 -6.7,-4.9 -10.1,-7.3 -3.1,-2.1 -5.7,-1.8 -7.9,1.2 -2.9,3.8 -5.6,7.8 -8.4,11.6 -1.1,1.5 -1.4,3.2 -1.1,5 1,6.1 1.9,12.3 3,18.4 0.7,4 2.4,5.1 7,4.9 z" class="st13" /><path  inkscape:connector-curvature="0" id="path107" d="m 1167.5,385 c -0.2,9.3 -7.2,17 -17.2,16.9 -9.3,0 -16.8,-7.7 -16.7,-16.9 0.1,-9.7 7.6,-17 17.2,-16.9 9.2,0 16.7,7.7 16.7,16.9 z" class="st1" /><path data-button="b" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path109" d="m 1150.5,398.9 c 7.6,0 13.8,-6 13.9,-13.6 0.2,-7.7 -6.1,-14.2 -13.9,-14.2 -7.5,0 -13.8,6.1 -13.9,13.6 -0.1,7.8 6.1,14.2 13.9,14.2 z" class="st7" /><path  inkscape:connector-curvature="0" id="path111" d="m 1140.4,422.7 c -0.1,9.2 -7.3,17 -17.3,16.8 -10.3,-0.3 -16.6,-8.3 -16.6,-17 0.1,-9 7.1,-16.9 17.3,-16.8 9.4,0.1 16.6,7.7 16.6,17 z" class="st1" /><path data-button="a" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path113" d="m 1137.3,423.2 c 0.3,-7.8 -5.6,-14.2 -13.3,-14.5 -7.5,-0.3 -14.1,5.2 -14.4,13.5 -0.3,7.1 4.9,14.1 13.7,14.2 9.1,0.2 14,-7.2 14,-13.2 z" class="st8" /><path  inkscape:connector-curvature="0" id="path115" d="m 1069,394.9 c 0.4,-8.7 7.1,-16.5 17.3,-16.4 9.5,0.1 16.8,7.9 16.6,17.5 -0.2,8.5 -7.4,16.8 -17.7,16.3 -9.4,-0.4 -16.5,-8.1 -16.2,-17.4 z" class="st1" /><path data-button="x" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path117" d="m 1086.1,409.3 c 7,0.3 13.9,-6 13.8,-14.1 -0.1,-6.3 -4.9,-13.6 -13.8,-13.6 -9.2,0 -14.1,7.3 -14,13.9 0,8.7 7.2,14.2 14,13.8 z" class="st9" /><path  inkscape:connector-curvature="0" id="path119" d="m 1112.6,374.8 c -8.3,0.1 -16.5,-6.7 -16.6,-16.9 -0.1,-9.4 7.9,-17 17.3,-16.9 9.3,0.2 16.6,7.8 16.6,17.1 0,9.5 -7.9,17.1 -17.3,16.7 z" class="st1" /><path data-button="y" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path121" d="m 1126.8,358.1 c 0.2,-7.3 -5.6,-14.1 -13.8,-14 -7.9,0 -13.8,6.1 -13.9,14 -0.1,7.5 6.1,13.5 13.7,13.7 7.1,0.3 14.2,-5.8 14,-13.7 z" class="st6" /><path  inkscape:connector-curvature="0" id="path127" d="m 997.66916,378.6627 c 5.89984,-0.2 9.19984,5.1 6.89984,9.6 -0.9,1.7 -2.2,2.7 -4.1,3 -4.9998,0.8 -10.0998,1.8 -15.0998,2.5 -3.6,0.5 -6.1,-1.5 -6.7,-5.2 -0.7,-3.8 0.8,-6.6 4.3,-7.4 5,-1.1 10.3,-1.8 14.69996,-2.5 z" class="st1" /><path data-button="start" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path129" d="m 998.6691,381.6627 c -0.29998,0 -0.59998,0 -0.99994,0.1 -2.79996,0.5 -5.69996,0.9 -8.49996,1.4 -1.9,0.3 -3.8,0.5 -5.6,1 -1.8,0.5 -2.5,1.7 -2.2,3.6 0.4,2.2 1.4,3.3 3.5,3 4.9,-0.7 9.7,-1.5 14.59984,-2.3 1.89996,-0.3 2.69996,-1.7 2.39996,-3.5 -0.2,-2.4 -1.1,-3.3 -3.1999,-3.3 z" class="st14" /><path  inkscape:connector-curvature="0" id="path139" d="m 952.8692,399.0627 c -5.6,0.3 -9,-4.9 -6.8,-9.5 0.8,-1.7 2.2,-2.7 4.1,-3.1 5.2,-0.9 10.4,-1.8 15.6,-2.6 3,-0.4 5.2,1.3 6,4.3 0.1,0.5 0.2,0.9 0.3,1.4 0.7,3.7 -1,6.3 -4.6,7.1 -2,0.5 -4.1,0.7 -6.1,1 -3,0.5 -6,1 -8.5,1.4 z" class="st1" /><path data-button="menu" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path141" d="m 952.1692,396.0627 c 2.6,-0.4 5.6,-0.9 8.5,-1.3 2.2,-0.4 4.4,-0.7 6.6,-1.2 1.7,-0.4 2.2,-1.7 1.8,-3.8 -0.4,-2.1 -1.3,-3.1 -3.2,-2.8 -5,0.7 -10.1,1.6 -15.1,2.5 -1.8,0.3 -2.4,1.7 -2.1,3.6 0.4,2.1 1.3,3 3.5,3 z" class="st14" /><path data-button="right_stick" inkscape:connector-curvature="0" id="path155" d="m 1054.7521,456.13593 c -0.1337,10.43141 -8.7597,18.65618 -19.3249,18.52244 -8.8934,-0.13373 -18.5224,-7.08801 -18.3887,-19.12425 0.1338,-10.23081 8.0242,-18.65618 18.9905,-18.52245 11.9026,0.13374 18.9237,9.76274 18.7231,19.12426 z" class="st1" /><path sodipodi:nodetypes="sccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc" class="st1" inkscape:connector-curvature="0" id="path19-8" d="m 821.2623,314.53667 c -3.2375,0.51252 -6.4623,1.0639 -9.6622,1.7637 -26.1001,5.60001 -44.0003,28.79924 -43.8003,54.59925 0,2.69999 -0.7012,4.80039 -2.4012,6.90039 -15.4,19.5 -22.1997,41.50076 -19.9997,66.30076 1.6,18.49999 8.401,34.99923 20.001,49.49922 6.1999,7.80002 13.5995,14.4005 22.0995,19.7005 2.1001,1.29999 3.0989,2.79985 3.3989,5.29985 1.1,7.9 2.5001,15.79936 3.8003,23.69931 3.1999,19.40002 -5.3303,-32.25398 -2.1294,-12.85412 0.9004,5.59992 1.5997,11.10061 3.1997,16.50061 7.6,25.00001 33.199,43.49957 63.399,38.39958 l 22.2003,-3.60032 c 4.9,-0.80006 9.7005,-1.89947 14.3005,-3.79947 25.8001,-10.50001 37.6995,-36.90066 34.1995,-59.00067 -0.7998,-5.40003 -1.599,-10.70074 -2.4989,-16.10075 -3.2999,-20.50001 4.9299,30.05556 1.629,9.5557 -0.8998,-5.80004 -0.6996,-5.10009 4.3004,-4.1001 15.8,3.1 34.3997,-5.79932 40.6997,-23.79932 1.6,-4.5 2.1007,-9.00039 2.0007,-13.70038 -0.1001,-2.6 0.1007,-2.70094 2.5007,-3.10094 5.5999,-0.90004 11.1003,-1.79948 16.6002,-2.69947 1.3,-0.30004 2.4991,-0.40096 3.7991,-0.50113 0.8999,-0.1 1.4998,0.3016 1.7997,1.20162 0.2,0.9 0.5001,1.79917 0.8002,2.69916 4.3999,12.4 13.0993,20.30082 25.6993,23.70082 6,1.60001 12.0014,1.39932 18.0014,-0.10067 1.3,-0.30004 1.8003,-9e-5 2.1003,1.19991 0.1997,0.70005 0.3991,1.49918 0.4991,2.29918 3.9999,24.30001 -3.7302,-22.45357 0.1697,1.84645 0.9985,6.10025 2.7985,11.79939 5.5984,17.29939 10.6,20.70001 33.5016,32.70108 55.6015,29.90109 7.7,-1 15.4999,-2.39967 23.1998,-3.59967 4.6001,-0.69998 9.1994,-1.40002 13.5993,-2.80001 24.3001,-7.70002 42.8014,-32.49989 37.9015,-62.8999 -1.5003,-8.79995 8.6297,53.354 7.2302,44.55392 -3.1005,-18.69992 -6,-37.60016 -9.1996,-56.30021 -0.7003,-3.99995 -0.5991,-7.19952 2.9009,-9.69953 20,-22.4 28.1992,-48.50095 23.0991,-78.10094 -5.1,-29.7 -21.5995,-51.69956 -48.1994,-66.09959 -2.5002,-1.39996 -4.2013,-2.89944 -5.4013,-5.59945 -9.8,-22.69999 -34.1999,-37.00046 -60.2999,-32.50046 -8.4,1.40003 -16.7989,2.60053 -25.0989,4.10034 -19.4,3.4 -33.3004,14.09859 -41.9005,31.69859 -0.6999,1.30001 -1.2001,2.60104 -1.7002,4.00103 -0.4,1.2 -1.0998,1.79989 -2.3998,1.99988 -5.6,0.80001 -11.1003,1.79948 -16.6004,2.69948 -2.5,0.40011 -5.0998,0.69955 -7.5999,1.09955 l -69.1993,11.20051 -32.6997,5.40015 c -1.9001,0.39998 -3.4006,0.4003 -4.5006,-1.49971 -0.2,-0.4 -0.6004,-0.69946 -0.9003,-1.09947 -14.1,-15.4 -31.3002,-21.50068 -51.9002,-18.40068 -2.8001,0.39998 -5.6993,0.80021 -8.4993,1.30016 -3.2501,0.55003 -6.4997,1.024 -9.7371,1.53651 z m 11.7374,1.28885 c 2.5249,-0.40004 5.0497,-0.77521 7.5996,-1.12524 18.3,-2.69999 33.799,2.80048 46.699,15.80049 0.7001,0.69998 1.3008,1.39892 1.8008,2.19892 0.4,0.69999 0.099,1.30114 -0.7009,1.40115 l -17.9998,2.99979 c -12.7001,2.10005 -25.4984,4.09977 -38.2984,6.19976 -5.2,0.80001 -10.5008,1.50015 -15.6007,2.70013 -15.6,3.50001 -29.4011,10.59918 -41.301,21.29916 -0.9,0.90001 -1.7985,1.7995 -2.7985,2.5995 -0.3001,0.20001 -0.8011,0.40045 -1.2011,0.40045 -0.7,1e-5 -0.4995,-0.69923 -0.5995,-1.09924 l -5e-4,-0.80144 c 1.3,-24.2 18.0013,-42.99847 39.3013,-48.39848 5.0001,-1.4 10.2986,-2.00112 15.4986,-2.9011 2.5499,-0.45004 5.0761,-0.87387 7.6011,-1.27392 z m 242.4158,-39.26146 c 6.6281,-1.08293 13.2829,-2.0386 19.8829,-3.16354 2.6999,-0.50002 5.4015,-0.60127 8.2014,-0.70126 20.6,1 36.199,10.10076 46.299,28.30075 0.3999,0.70002 0.6993,1.4995 0.9992,2.19951 0.1,0.20006 0.1003,0.69952 3e-4,0.79952 -0.1999,0.19999 -0.5993,0.30064 -0.8993,0.20061 -1.1,-0.29999 -2.0997,-0.60017 -3.1997,-1.00016 -14.4,-4.90001 -29.0999,-6.10062 -43.9999,-3.70062 l -59.1003,9.60086 c -4.5,0.70003 -9.1,1.40011 -13.7001,2.10007 -0.9999,0.19995 -1.501,-0.50056 -1.201,-1.40055 0.4001,-1.10002 0.8017,-2.09864 1.3017,-3.09865 8.2,-15.99999 21.0995,-25.80011 38.7995,-29.00011 2.2,-0.40004 4.4069,-0.77547 6.6163,-1.13641 z m -241.7668,69.57229 c 4.6501,-0.76218 9.3009,-1.48609 13.951,-2.2361 12.7,-2.10005 25.5002,-4.10007 38.3003,-6.20008 12.9,-2.10005 25.8986,-4.19951 38.7986,-6.29946 12.6999,-2.10003 25.5003,-4.10007 38.3003,-6.20006 12.7,-2.00003 25.5002,-4.10017 38.3003,-6.20008 12.7,-2.10003 25.5003,-4.10007 38.3003,-6.20006 12.7,-2.00003 25.5003,-4.10007 38.3003,-6.20006 8.6,-1.39963 17.2995,-2.79954 25.9995,-4.09951 20.7001,-3.00001 40.1999,0.59808 58.0999,11.29809 23.8,14.19999 38.2007,35.10163 42.8007,62.40164 7.9,47.19999 -23.4013,91.59918 -69.0013,101.29919 -20.7,4.39999 -40.5993,1.80101 -59.5993,-7.79898 -1.2,-0.6 -2.3006,-1.20142 -3.4006,-1.90141 -1.9,-1.20001 -2.0006,-1.1999 -1.5007,-3.3999 1.3001,-6.20001 1.3011,-12.40027 -0.4989,-18.50027 -5.1,-17.8 -21.5007,-26.19847 -34.5008,-26.39846 -14.9999,-0.20002 -31.9985,9.79884 -36.1986,29.09885 -0.5999,2.79999 -0.6009,5.70067 -0.6009,8.60065 -0.1001,2.90003 -0.1989,3.09918 -3.1989,3.59919 -4.5,0.80003 -9.1013,1.50124 -13.7013,2.20121 -1.9001,0.29998 -3.7991,0.6993 -5.6992,0.89926 -1.1,0.1 -1.9002,-0.19927 -2.2002,-1.39928 -0.2999,-1.30001 -0.7006,-2.5009 -1.1006,-3.70089 -5.6,-15.10001 -20.7004,-24.89906 -36.9003,-23.59906 -16.4,1.39998 -28.9994,12.6996 -32.6995,27.99962 -1.8999,7.99998 -1.2004,15.90017 2.3995,23.40018 1.2001,2.39999 0.9005,3.90001 -0.7996,5.90002 -14.1999,16.79999 -31.8999,27.20021 -53.5999,31.10021 -34.5,6.19999 -69.3991,-9.10173 -88.8991,-37.80173 -9.9999,-14.80001 -15.3004,-32.2994 -15.3004,-50.19941 0.1,-42.49999 30.3002,-79.0996 71.9002,-86.99959 4.65,-0.90001 9.2993,-1.70096 13.9493,-2.46346 z m 100.1827,92.4546 c 1.7301,-0.29526 3.5213,-0.46269 5.3681,-0.4908 19.1,-0.29999 33.699,15.09879 33.799,33.19879 0.2001,16.69999 -12.7995,33.50034 -33.3995,33.60034 -19.1,0.1 -33.2993,-15.39891 -33.3993,-33.19892 -0.091,-15.49687 10.9063,-30.25524 27.6317,-33.10941 z m 97.0951,-15.78068 c 1.7122,-0.26923 3.4726,-0.40986 5.2725,-0.40985 14.9,0 33.0001,11.89923 33.1001,33.49923 0.1,17.6 -13.9001,33.49923 -33.7001,33.29924 -21.2,-0.20001 -33.5005,-17.99877 -33.0006,-33.39875 -0.2719,-15.76876 11.7764,-30.38742 28.3281,-32.98987 z m -121.5826,70.27437 c 0.1713,-0.025 0.3548,-0.0214 0.5547,0.0161 1,0.3 1.7011,1.79926 2.6011,2.69926 2.9,3.1 5.9995,5.79883 9.7997,7.5988 1.9999,0.90001 2.7992,2.3009 3.0992,4.4009 1.1001,6.89999 2.3006,13.90002 3.4046,20.79936 2.3997,15.00006 -6.7323,-41.05446 -4.3317,-26.05456 0.9,5.50001 1.9021,11.00097 2.5017,16.60103 2.1,17.8 -3.8013,32.79934 -16.6012,44.99932 -8.4,8.00001 -18.5986,12.10068 -29.9986,13.80068 -7.4,1.1 -14.8006,2.4984 -22.2006,3.59835 -2.9999,0.50017 -6.1011,0.59998 -9.1011,0.89997 -25.2999,0 -47.8,-18.599 -52.0001,-44.099 -2.8974,-17.70043 5.9326,35.75387 3.0323,18.05392 -1.8003,-10.79995 -3.6015,-21.69855 -5.4009,-32.59865 -3e-4,-0.19994 -0.1,-0.30021 -0.1002,-0.50015 0.1,-1.9 -1.0998,-3.7 2e-4,-5.5 1.8,0.2 3.2,1.2989 4.8,1.9989 14.8,6.5 30.2001,9.20004 46.3002,7.50003 24.4999,-2.49998 44.8002,-13.19961 61.1002,-31.5996 0.7874,-0.875 1.3454,-2.43895 2.5445,-2.61532 z m 160.624,-23.07648 c 0.083,-0.0242 0.1702,-0.035 0.2605,-0.0288 0.1203,0.008 0.2449,0.0445 0.3698,0.11956 l 3.0008,1.50177 c 10.2,5.6 21.1005,9.09813 32.7005,10.29813 25.1,2.5 47.8993,-3.69809 67.8994,-19.2981 l 2.7,-2.10047 c 0.7,-0.4 1.3006,-0.30146 1.5006,0.4985 0.2001,0.9 0.3994,1.9013 0.5991,2.80135 2.3997,14.40005 4.6979,28.69969 6.9993,43.09947 2.1001,12.69998 -7.5308,-45.55408 -5.4305,-32.75413 0.6,3.3 0.8005,6.59953 0.9007,9.99951 0.3999,23.60002 -16.7008,46.99998 -42.9008,51.79999 -10.3,1.90001 -20.6982,3.901 -31.1981,4.90099 -24.6,2.4 -48.101,-13.80002 -55.0011,-37.90001 -1.2999,-4.4 -1.9001,-8.80061 -2.6001,-13.20062 -3.5997,-21.70004 4.5307,27.55478 1.0312,5.75471 4e-4,-0.40006 -0.1005,-0.70081 -0.101,-1.00074 -0.1,-1.6 -0.7001,-3.29878 -0.3001,-4.69878 0.5001,-1.50001 2.6012,-1.70093 3.9012,-2.50092 5.7,-3.40001 10.2002,-8.00052 13.5002,-13.90051 0.5,-0.89999 0.9994,-1.99998 1.5994,-2.89998 0.1125,-0.22499 0.32,-0.41834 0.5688,-0.49091 z"  /><path data-button="left_stick" inkscape:connector-curvature="0" id="path155-7" d="m 958.52991,471.80838 c -0.1337,10.43141 -8.7597,18.65618 -19.3249,18.52244 -8.8934,-0.13373 -18.5224,-7.08801 -18.3887,-19.12425 0.1338,-10.23081 8.0242,-18.65618 18.9905,-18.52245 11.9026,0.13374 18.9237,9.76274 18.7231,19.12426 z" class="st1" /><path data-button="right_bumper" sodipodi:nodetypes="ccccccc" class="st4" d="m 1103.5,272.7 c -2.8,0.1 -5.5,0.2 -8.2,0.7 -8.8,1.5 -17.7,2.7 -26.5,4.3 -13.2318,2.39218 -23.7811,8.47272 -31.6897,18.07452 17.6279,-5.01741 34.0063,-12.93148 53.0125,-14.75341 15.655,-4.5304 29.3137,-0.0603 43.6264,1.46149 -8.3983,-6.01363 -18.5122,-9.21284 -30.2492,-9.7826 z" id="path5612" inkscape:connector-curvature="0" style="fill:#f6d6d6;fill-opacity:1" /><path data-button="left_bumper" sodipodi:nodetypes="ccccccc" class="st4" d="m 806.11682,321.0246 c 2.68575,-0.79797 5.27672,-1.56404 7.99523,-1.951 8.81898,-1.38405 17.63709,-3.08433 26.48795,-4.3736 13.30394,-1.95145 25.24137,0.44824 35.79863,7.02736 -18.30763,0.86488 -36.35454,-1.41412 -54.94969,2.91892 -16.28242,0.69743 -27.80303,9.28914 -40.88355,15.29492 6.04263,-8.37746 14.60865,-14.63439 25.55143,-18.9166 z" id="path5612-2" inkscape:connector-curvature="0" style="fill:#f6d6d6;fill-opacity:1" /></g></g></svg>`

                    parent.innerHTML = svgSrc;

                    var svg = parent.children[0];

                    svg.style.width = "100%";
                    svg.style.maxHeight = "100%";

                    var buttons = {};

                    var buttonElems = svg.querySelectorAll("[data-button]");

                    for (var i = 0; i < buttonElems.length; i++) {
                        buttons[buttonElems[i].getAttribute("data-button")] = buttonElems[i];
                    }

                    state.buttons = buttons;

                    parent.classList.add("nopadding");
                    parent.classList.add("nooverflow");
                },
                reset: function (parent, state) {
                    var buttons = Object.values(state.buttons);
                    for (var i = 0; i < buttons.length; i++) {
                        buttons[i].style.fill = "var(--widget-inner-background-color)";
                    }
                },
                ondata: function (data, parent, state) {
                    if (data.gamepad1) {

                        var entries = Object.entries(state.buttons);
                        for (var i = 0; i < entries.length; i++) {
                            if (data.gamepad1[entries[i][0]]) {
                                entries[i][1].style.fill = "var(--widget-text-color)";
                            } else {
                                entries[i][1].style.fill = "var(--widget-inner-background-color)";
                            }
                        }

                        state.buttons.right_stick.style.transform = `translate(${data.gamepad1.right_stick_x * 15}px, ${data.gamepad1.right_stick_y * 10}px)`;
                        state.buttons.right_stick.style.fill = "var(--widget-text-color)";

                        state.buttons.left_stick.style.transform = `translate(${data.gamepad1.left_stick_x * 15}px, ${data.gamepad1.left_stick_y * 10}px)`;
                        state.buttons.left_stick.style.fill = "var(--widget-text-color)";
                    }
                }
            },
            "input.gamepad2": {
                init: function (parent, state) {
                    var svgSrc = `<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" x="0px" y="0px" viewBox="0 0 511.99999 512" xml:space="preserve" id="svg252" sodipodi:docname="Joystick Game Controls Vector.svg" inkscape:version="0.92.4 (5da689c313, 2019-01-14)" width="512" height="512"><metadata id="metadata258"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><defs id="defs256" /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1017" id="namedview254" showgrid="false" inkscape:zoom="0.75009178" inkscape:cx="131.46842" inkscape:cy="155.92237" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="Capa_1" inkscape:snap-smooth-nodes="true" inkscape:snap-intersection-paths="true" inkscape:object-paths="true" inkscape:snap-midpoints="true" inkscape:snap-bbox="true" inkscape:snap-bbox-midpoints="true" inkscape:bbox-paths="true" inkscape:bbox-nodes="true" inkscape:snap-bbox-edge-midpoints="true" inkscape:snap-page="true" /><style type="text/css" id="style2"> .st0{fill:#E9F2FF;} .st2{fill:#89A2B0;} .st3{fill:#CED8DC;} .st4{fill:#D6E9F6;} .st5{fill:#AAC9D6;} .st6{fill:#FAE0D6;} .st7{fill:#EB6777;} .st8{fill:#00C2A2;} .st9{fill:#F8E8A0;} .st10{fill:#FFFFFF;} .st11{fill:#EBBE62;} .st12{fill:#FF6F4C;} .st13{fill:#BAD6E5;} .st14{fill:#2D3130;} .st15{fill:#B1C3C9;} .st16{fill:#6A8693;} .st17{fill:#7FB0C6;}</style><switch id="switch250" transform="translate(0,-692.69995)"> <foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"> </foreignObject> </switch> <g id="Capa_1" transform="rotate(9.2963007,4360.9329,1794.1369)"><g id="g5656" transform="matrix(1.0315332,0,0,1.0315332,-948.80632,499.01779)"><path data-button="left_trigger" style="fill:#d6e9f6" inkscape:connector-curvature="0" id="path33" d="m 770.6,368.4 c 0,0.5 0,0.7 0,0.8 0.1,0.4 -0.1,1.1 0.6,1.1 0.4,0 0.9,-0.2 1.2,-0.4 1,-0.8 1.9,-1.7 2.8,-2.6 11.9,-10.7 25.7,-17.8 41.3,-21.3 5.1,-1.2 10.4,-1.9 15.6,-2.7 12.8,-2.1 25.6,-4.1 38.3,-6.2 6,-1 12,-2 18,-3 0.8,-0.1 1.1,-0.7 0.7,-1.4 -0.5,-0.8 -1.1,-1.5 -1.8,-2.2 -12.9,-13 -28.4,-18.5 -46.7,-15.8 -5.1,0.7 -10.1,1.5 -15.2,2.4 -5.2,0.9 -10.5,1.5 -15.5,2.9 -21.3,5.4 -38,24.2 -39.3,48.4 z" class="st4" /><path data-button="right_trigger" style="fill:#d6e9f6" inkscape:connector-curvature="0" id="path35" d="m 1103.5,272.7 c -2.8,0.1 -5.5,0.2 -8.2,0.7 -8.8,1.5 -17.7,2.7 -26.5,4.3 -17.7,3.2 -30.6,13 -38.8,29 -0.5,1 -0.9,2 -1.3,3.1 -0.3,0.9 0.2,1.6 1.2,1.4 4.6,-0.7 9.2,-1.4 13.7,-2.1 19.7,-3.2 39.4,-6.4 59.1,-9.6 14.9,-2.4 29.6,-1.2 44,3.7 1.1,0.4 2.1,0.7 3.2,1 0.3,0.1 0.7,0 0.9,-0.2 0.1,-0.1 0.1,-0.6 0,-0.8 -0.3,-0.7 -0.6,-1.5 -1,-2.2 -10.1,-18.2 -25.7,-27.3 -46.3,-28.3 z" class="st4" /><path  inkscape:connector-curvature="0" id="path91" d="m 847.4,410.4 c 0.1,2 -0.4,3.8 -1.6,5.4 -2.6,3.6 -5.1,7.3 -7.9,10.9 -3.1,3.9 -7.3,4.7 -11.4,2 -4.4,-2.9 -8.6,-6.1 -12.8,-9.2 -1.7,-1.3 -2.7,-3.1 -3,-5.3 -1.2,-7.4 -2.5,-14.8 -3.6,-22.2 -0.8,-5.7 1.7,-9.1 7.5,-10.2 6.4,-1.2 12.9,-2.3 19.3,-3.2 4.7,-0.7 8.5,2.1 9.5,6.8 0.6,2.8 1,5.7 1.4,8.5 0.8,4.6 1.5,9.1 2.2,13.7 0.2,0.9 0.3,1.9 0.4,2.8 z" class="st1" /><path data-button="dpad_up"  inkscape:connector-curvature="0" id="path93" d="m 844.4,410.5 c -0.1,-0.8 -0.1,-1.6 -0.3,-2.4 -0.8,-4.7 -1.6,-9.4 -2.4,-14.2 -0.4,-2.7 -0.7,-5.4 -1.3,-8 -0.7,-3 -3,-4.7 -6,-4.3 -6.6,1 -13.2,2.1 -19.8,3.3 -3.6,0.7 -5.2,3 -4.6,6.6 1.1,7.3 2.4,14.5 3.5,21.7 0.3,1.8 1.2,3.3 2.7,4.4 3.9,2.8 7.7,5.7 11.7,8.4 3.1,2.1 5.6,1.6 7.9,-1.4 2.5,-3.3 4.9,-6.7 7.3,-10.1 0.8,-1.2 1.4,-2.5 1.3,-4 z" class="st13" /><path  inkscape:connector-curvature="0" id="path95" d="m 890.7,437.1 c 0.1,4.7 -2.1,7.7 -6.7,8.6 -5.2,1.1 -10.4,1.8 -15.6,2.7 -2.2,0.4 -4.4,0.7 -6.6,1 -3,0.5 -5.7,-0.1 -8.1,-2 -2.9,-2.2 -6,-4.3 -8.9,-6.5 -4.6,-3.5 -5.3,-7.7 -2,-12.5 2.7,-3.9 5.6,-7.8 8.4,-11.7 1.7,-2.4 3.9,-3.6 6.7,-4.1 6.6,-1 13.2,-2.3 19.8,-3.3 4.7,-0.7 8.7,2 9.6,6.6 1.2,6.6 2.2,13.2 3.2,19.8 0.1,0.6 0.1,1.1 0.2,1.4 z" class="st1" /><path data-button="dpad_right"  inkscape:connector-curvature="0" id="path97" d="m 887.6,436.1 c -0.3,-1.6 -0.6,-3.8 -1,-6 -0.7,-4.3 -1.3,-8.5 -2.1,-12.7 -0.7,-3.6 -3,-5.4 -6.4,-4.9 -6.6,1 -13.2,2.2 -19.8,3.2 -1.9,0.3 -3.3,1.1 -4.4,2.6 -2.9,4 -5.9,8 -8.7,12 -2.2,3.3 -1.7,5.9 1.4,8.3 3,2.3 6.2,4.5 9.3,6.7 1.7,1.2 3.5,1.5 5.4,1.2 1.9,-0.3 3.8,-0.6 5.7,-0.9 5.2,-0.9 10.4,-1.6 15.6,-2.6 3.9,-0.8 5.2,-2.6 5,-6.9 z" class="st13" /><path  inkscape:connector-curvature="0" id="path99" d="m 804.9,421.3 c 2.7,-0.2 4.8,0.3 6.7,1.7 4,2.9 8.1,5.7 12,8.7 4.2,3.3 4.9,7.7 1.9,12.2 -2.2,3.3 -4.6,6.5 -7,9.7 -1.5,2 -3.4,3.3 -5.9,3.7 -5.2,0.8 -10.4,1.7 -15.6,2.6 -2.4,0.4 -4.7,0.7 -7.1,1.1 -4.6,0.7 -8.7,-1.9 -9.6,-7.2 -1.1,-6.4 -2.2,-12.9 -3.1,-19.4 -0.9,-6 3.1,-9.3 6.8,-9.9 6.6,-1.1 13.2,-2.1 19.8,-3.2 0.6,0.1 1.1,0 1.1,0 z" class="st1" /><path data-button="dpad_left"  inkscape:connector-curvature="0" id="path101" d="m 805.8,424.3 c -1,0.1 -1.4,0.1 -1.9,0.2 -6.3,1 -12.6,1.9 -18.9,3.1 -3.7,0.7 -5.3,3.1 -4.7,7 0.6,4.3 1.4,8.5 2.1,12.8 0.3,1.9 0.5,3.8 0.9,5.7 0.9,4.2 2.9,5.6 7.2,5 1.9,-0.2 3.8,-0.6 5.7,-0.9 5,-0.8 10.1,-1.7 15.1,-2.5 2.4,-0.4 4.1,-1.5 5.4,-3.5 2,-2.9 4.2,-5.7 6.1,-8.6 2.4,-3.5 2,-6.1 -1.4,-8.6 -3.7,-2.8 -7.5,-5.4 -11.2,-8.2 -1.5,-1.1 -3.1,-1.7 -4.4,-1.5 z" class="st13" /><path  inkscape:connector-curvature="0" id="path103" d="m 830.3,491 c -4.3,0 -7.3,-2.3 -8.2,-6.6 -1.3,-6.7 -2.3,-13.5 -3.4,-20.3 -0.3,-2.1 0.3,-4.1 1.6,-5.9 3,-4.2 5.8,-8.4 9,-12.4 3,-3.8 7.4,-4.4 11.5,-1.7 3.7,2.5 7.3,5.2 10.9,7.8 1.9,1.4 3,3.3 3.4,5.6 1.1,6.9 2.4,13.8 3.4,20.8 0.6,4.5 -2,8.5 -6.4,9.3 -6.9,1.3 -13.9,2.2 -20.8,3.3 -0.3,0.1 -0.7,0.1 -1,0.1 z" class="st1" /><path data-button="dpad_down"  inkscape:connector-curvature="0" id="path105" d="m 832,487.9 c 1.7,-0.3 4.1,-0.7 6.4,-1 4.1,-0.7 8.2,-1.2 12.3,-2 3.3,-0.6 5.2,-3 4.8,-6.1 -1,-6.9 -2.3,-13.9 -3.4,-20.8 -0.3,-1.7 -1.3,-2.9 -2.6,-3.9 -3.4,-2.4 -6.7,-4.9 -10.1,-7.3 -3.1,-2.1 -5.7,-1.8 -7.9,1.2 -2.9,3.8 -5.6,7.8 -8.4,11.6 -1.1,1.5 -1.4,3.2 -1.1,5 1,6.1 1.9,12.3 3,18.4 0.7,4 2.4,5.1 7,4.9 z" class="st13" /><path  inkscape:connector-curvature="0" id="path107" d="m 1167.5,385 c -0.2,9.3 -7.2,17 -17.2,16.9 -9.3,0 -16.8,-7.7 -16.7,-16.9 0.1,-9.7 7.6,-17 17.2,-16.9 9.2,0 16.7,7.7 16.7,16.9 z" class="st1" /><path data-button="b" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path109" d="m 1150.5,398.9 c 7.6,0 13.8,-6 13.9,-13.6 0.2,-7.7 -6.1,-14.2 -13.9,-14.2 -7.5,0 -13.8,6.1 -13.9,13.6 -0.1,7.8 6.1,14.2 13.9,14.2 z" class="st7" /><path  inkscape:connector-curvature="0" id="path111" d="m 1140.4,422.7 c -0.1,9.2 -7.3,17 -17.3,16.8 -10.3,-0.3 -16.6,-8.3 -16.6,-17 0.1,-9 7.1,-16.9 17.3,-16.8 9.4,0.1 16.6,7.7 16.6,17 z" class="st1" /><path data-button="a" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path113" d="m 1137.3,423.2 c 0.3,-7.8 -5.6,-14.2 -13.3,-14.5 -7.5,-0.3 -14.1,5.2 -14.4,13.5 -0.3,7.1 4.9,14.1 13.7,14.2 9.1,0.2 14,-7.2 14,-13.2 z" class="st8" /><path  inkscape:connector-curvature="0" id="path115" d="m 1069,394.9 c 0.4,-8.7 7.1,-16.5 17.3,-16.4 9.5,0.1 16.8,7.9 16.6,17.5 -0.2,8.5 -7.4,16.8 -17.7,16.3 -9.4,-0.4 -16.5,-8.1 -16.2,-17.4 z" class="st1" /><path data-button="x" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path117" d="m 1086.1,409.3 c 7,0.3 13.9,-6 13.8,-14.1 -0.1,-6.3 -4.9,-13.6 -13.8,-13.6 -9.2,0 -14.1,7.3 -14,13.9 0,8.7 7.2,14.2 14,13.8 z" class="st9" /><path  inkscape:connector-curvature="0" id="path119" d="m 1112.6,374.8 c -8.3,0.1 -16.5,-6.7 -16.6,-16.9 -0.1,-9.4 7.9,-17 17.3,-16.9 9.3,0.2 16.6,7.8 16.6,17.1 0,9.5 -7.9,17.1 -17.3,16.7 z" class="st1" /><path data-button="y" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path121" d="m 1126.8,358.1 c 0.2,-7.3 -5.6,-14.1 -13.8,-14 -7.9,0 -13.8,6.1 -13.9,14 -0.1,7.5 6.1,13.5 13.7,13.7 7.1,0.3 14.2,-5.8 14,-13.7 z" class="st6" /><path  inkscape:connector-curvature="0" id="path127" d="m 997.66916,378.6627 c 5.89984,-0.2 9.19984,5.1 6.89984,9.6 -0.9,1.7 -2.2,2.7 -4.1,3 -4.9998,0.8 -10.0998,1.8 -15.0998,2.5 -3.6,0.5 -6.1,-1.5 -6.7,-5.2 -0.7,-3.8 0.8,-6.6 4.3,-7.4 5,-1.1 10.3,-1.8 14.69996,-2.5 z" class="st1" /><path data-button="start" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path129" d="m 998.6691,381.6627 c -0.29998,0 -0.59998,0 -0.99994,0.1 -2.79996,0.5 -5.69996,0.9 -8.49996,1.4 -1.9,0.3 -3.8,0.5 -5.6,1 -1.8,0.5 -2.5,1.7 -2.2,3.6 0.4,2.2 1.4,3.3 3.5,3 4.9,-0.7 9.7,-1.5 14.59984,-2.3 1.89996,-0.3 2.69996,-1.7 2.39996,-3.5 -0.2,-2.4 -1.1,-3.3 -3.1999,-3.3 z" class="st14" /><path  inkscape:connector-curvature="0" id="path139" d="m 952.8692,399.0627 c -5.6,0.3 -9,-4.9 -6.8,-9.5 0.8,-1.7 2.2,-2.7 4.1,-3.1 5.2,-0.9 10.4,-1.8 15.6,-2.6 3,-0.4 5.2,1.3 6,4.3 0.1,0.5 0.2,0.9 0.3,1.4 0.7,3.7 -1,6.3 -4.6,7.1 -2,0.5 -4.1,0.7 -6.1,1 -3,0.5 -6,1 -8.5,1.4 z" class="st1" /><path data-button="menu" style="fill:#bad6e5;fill-opacity:1" inkscape:connector-curvature="0" id="path141" d="m 952.1692,396.0627 c 2.6,-0.4 5.6,-0.9 8.5,-1.3 2.2,-0.4 4.4,-0.7 6.6,-1.2 1.7,-0.4 2.2,-1.7 1.8,-3.8 -0.4,-2.1 -1.3,-3.1 -3.2,-2.8 -5,0.7 -10.1,1.6 -15.1,2.5 -1.8,0.3 -2.4,1.7 -2.1,3.6 0.4,2.1 1.3,3 3.5,3 z" class="st14" /><path data-button="right_stick" inkscape:connector-curvature="0" id="path155" d="m 1054.7521,456.13593 c -0.1337,10.43141 -8.7597,18.65618 -19.3249,18.52244 -8.8934,-0.13373 -18.5224,-7.08801 -18.3887,-19.12425 0.1338,-10.23081 8.0242,-18.65618 18.9905,-18.52245 11.9026,0.13374 18.9237,9.76274 18.7231,19.12426 z" class="st1" /><path sodipodi:nodetypes="sccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc" class="st1" inkscape:connector-curvature="0" id="path19-8" d="m 821.2623,314.53667 c -3.2375,0.51252 -6.4623,1.0639 -9.6622,1.7637 -26.1001,5.60001 -44.0003,28.79924 -43.8003,54.59925 0,2.69999 -0.7012,4.80039 -2.4012,6.90039 -15.4,19.5 -22.1997,41.50076 -19.9997,66.30076 1.6,18.49999 8.401,34.99923 20.001,49.49922 6.1999,7.80002 13.5995,14.4005 22.0995,19.7005 2.1001,1.29999 3.0989,2.79985 3.3989,5.29985 1.1,7.9 2.5001,15.79936 3.8003,23.69931 3.1999,19.40002 -5.3303,-32.25398 -2.1294,-12.85412 0.9004,5.59992 1.5997,11.10061 3.1997,16.50061 7.6,25.00001 33.199,43.49957 63.399,38.39958 l 22.2003,-3.60032 c 4.9,-0.80006 9.7005,-1.89947 14.3005,-3.79947 25.8001,-10.50001 37.6995,-36.90066 34.1995,-59.00067 -0.7998,-5.40003 -1.599,-10.70074 -2.4989,-16.10075 -3.2999,-20.50001 4.9299,30.05556 1.629,9.5557 -0.8998,-5.80004 -0.6996,-5.10009 4.3004,-4.1001 15.8,3.1 34.3997,-5.79932 40.6997,-23.79932 1.6,-4.5 2.1007,-9.00039 2.0007,-13.70038 -0.1001,-2.6 0.1007,-2.70094 2.5007,-3.10094 5.5999,-0.90004 11.1003,-1.79948 16.6002,-2.69947 1.3,-0.30004 2.4991,-0.40096 3.7991,-0.50113 0.8999,-0.1 1.4998,0.3016 1.7997,1.20162 0.2,0.9 0.5001,1.79917 0.8002,2.69916 4.3999,12.4 13.0993,20.30082 25.6993,23.70082 6,1.60001 12.0014,1.39932 18.0014,-0.10067 1.3,-0.30004 1.8003,-9e-5 2.1003,1.19991 0.1997,0.70005 0.3991,1.49918 0.4991,2.29918 3.9999,24.30001 -3.7302,-22.45357 0.1697,1.84645 0.9985,6.10025 2.7985,11.79939 5.5984,17.29939 10.6,20.70001 33.5016,32.70108 55.6015,29.90109 7.7,-1 15.4999,-2.39967 23.1998,-3.59967 4.6001,-0.69998 9.1994,-1.40002 13.5993,-2.80001 24.3001,-7.70002 42.8014,-32.49989 37.9015,-62.8999 -1.5003,-8.79995 8.6297,53.354 7.2302,44.55392 -3.1005,-18.69992 -6,-37.60016 -9.1996,-56.30021 -0.7003,-3.99995 -0.5991,-7.19952 2.9009,-9.69953 20,-22.4 28.1992,-48.50095 23.0991,-78.10094 -5.1,-29.7 -21.5995,-51.69956 -48.1994,-66.09959 -2.5002,-1.39996 -4.2013,-2.89944 -5.4013,-5.59945 -9.8,-22.69999 -34.1999,-37.00046 -60.2999,-32.50046 -8.4,1.40003 -16.7989,2.60053 -25.0989,4.10034 -19.4,3.4 -33.3004,14.09859 -41.9005,31.69859 -0.6999,1.30001 -1.2001,2.60104 -1.7002,4.00103 -0.4,1.2 -1.0998,1.79989 -2.3998,1.99988 -5.6,0.80001 -11.1003,1.79948 -16.6004,2.69948 -2.5,0.40011 -5.0998,0.69955 -7.5999,1.09955 l -69.1993,11.20051 -32.6997,5.40015 c -1.9001,0.39998 -3.4006,0.4003 -4.5006,-1.49971 -0.2,-0.4 -0.6004,-0.69946 -0.9003,-1.09947 -14.1,-15.4 -31.3002,-21.50068 -51.9002,-18.40068 -2.8001,0.39998 -5.6993,0.80021 -8.4993,1.30016 -3.2501,0.55003 -6.4997,1.024 -9.7371,1.53651 z m 11.7374,1.28885 c 2.5249,-0.40004 5.0497,-0.77521 7.5996,-1.12524 18.3,-2.69999 33.799,2.80048 46.699,15.80049 0.7001,0.69998 1.3008,1.39892 1.8008,2.19892 0.4,0.69999 0.099,1.30114 -0.7009,1.40115 l -17.9998,2.99979 c -12.7001,2.10005 -25.4984,4.09977 -38.2984,6.19976 -5.2,0.80001 -10.5008,1.50015 -15.6007,2.70013 -15.6,3.50001 -29.4011,10.59918 -41.301,21.29916 -0.9,0.90001 -1.7985,1.7995 -2.7985,2.5995 -0.3001,0.20001 -0.8011,0.40045 -1.2011,0.40045 -0.7,1e-5 -0.4995,-0.69923 -0.5995,-1.09924 l -5e-4,-0.80144 c 1.3,-24.2 18.0013,-42.99847 39.3013,-48.39848 5.0001,-1.4 10.2986,-2.00112 15.4986,-2.9011 2.5499,-0.45004 5.0761,-0.87387 7.6011,-1.27392 z m 242.4158,-39.26146 c 6.6281,-1.08293 13.2829,-2.0386 19.8829,-3.16354 2.6999,-0.50002 5.4015,-0.60127 8.2014,-0.70126 20.6,1 36.199,10.10076 46.299,28.30075 0.3999,0.70002 0.6993,1.4995 0.9992,2.19951 0.1,0.20006 0.1003,0.69952 3e-4,0.79952 -0.1999,0.19999 -0.5993,0.30064 -0.8993,0.20061 -1.1,-0.29999 -2.0997,-0.60017 -3.1997,-1.00016 -14.4,-4.90001 -29.0999,-6.10062 -43.9999,-3.70062 l -59.1003,9.60086 c -4.5,0.70003 -9.1,1.40011 -13.7001,2.10007 -0.9999,0.19995 -1.501,-0.50056 -1.201,-1.40055 0.4001,-1.10002 0.8017,-2.09864 1.3017,-3.09865 8.2,-15.99999 21.0995,-25.80011 38.7995,-29.00011 2.2,-0.40004 4.4069,-0.77547 6.6163,-1.13641 z m -241.7668,69.57229 c 4.6501,-0.76218 9.3009,-1.48609 13.951,-2.2361 12.7,-2.10005 25.5002,-4.10007 38.3003,-6.20008 12.9,-2.10005 25.8986,-4.19951 38.7986,-6.29946 12.6999,-2.10003 25.5003,-4.10007 38.3003,-6.20006 12.7,-2.00003 25.5002,-4.10017 38.3003,-6.20008 12.7,-2.10003 25.5003,-4.10007 38.3003,-6.20006 12.7,-2.00003 25.5003,-4.10007 38.3003,-6.20006 8.6,-1.39963 17.2995,-2.79954 25.9995,-4.09951 20.7001,-3.00001 40.1999,0.59808 58.0999,11.29809 23.8,14.19999 38.2007,35.10163 42.8007,62.40164 7.9,47.19999 -23.4013,91.59918 -69.0013,101.29919 -20.7,4.39999 -40.5993,1.80101 -59.5993,-7.79898 -1.2,-0.6 -2.3006,-1.20142 -3.4006,-1.90141 -1.9,-1.20001 -2.0006,-1.1999 -1.5007,-3.3999 1.3001,-6.20001 1.3011,-12.40027 -0.4989,-18.50027 -5.1,-17.8 -21.5007,-26.19847 -34.5008,-26.39846 -14.9999,-0.20002 -31.9985,9.79884 -36.1986,29.09885 -0.5999,2.79999 -0.6009,5.70067 -0.6009,8.60065 -0.1001,2.90003 -0.1989,3.09918 -3.1989,3.59919 -4.5,0.80003 -9.1013,1.50124 -13.7013,2.20121 -1.9001,0.29998 -3.7991,0.6993 -5.6992,0.89926 -1.1,0.1 -1.9002,-0.19927 -2.2002,-1.39928 -0.2999,-1.30001 -0.7006,-2.5009 -1.1006,-3.70089 -5.6,-15.10001 -20.7004,-24.89906 -36.9003,-23.59906 -16.4,1.39998 -28.9994,12.6996 -32.6995,27.99962 -1.8999,7.99998 -1.2004,15.90017 2.3995,23.40018 1.2001,2.39999 0.9005,3.90001 -0.7996,5.90002 -14.1999,16.79999 -31.8999,27.20021 -53.5999,31.10021 -34.5,6.19999 -69.3991,-9.10173 -88.8991,-37.80173 -9.9999,-14.80001 -15.3004,-32.2994 -15.3004,-50.19941 0.1,-42.49999 30.3002,-79.0996 71.9002,-86.99959 4.65,-0.90001 9.2993,-1.70096 13.9493,-2.46346 z m 100.1827,92.4546 c 1.7301,-0.29526 3.5213,-0.46269 5.3681,-0.4908 19.1,-0.29999 33.699,15.09879 33.799,33.19879 0.2001,16.69999 -12.7995,33.50034 -33.3995,33.60034 -19.1,0.1 -33.2993,-15.39891 -33.3993,-33.19892 -0.091,-15.49687 10.9063,-30.25524 27.6317,-33.10941 z m 97.0951,-15.78068 c 1.7122,-0.26923 3.4726,-0.40986 5.2725,-0.40985 14.9,0 33.0001,11.89923 33.1001,33.49923 0.1,17.6 -13.9001,33.49923 -33.7001,33.29924 -21.2,-0.20001 -33.5005,-17.99877 -33.0006,-33.39875 -0.2719,-15.76876 11.7764,-30.38742 28.3281,-32.98987 z m -121.5826,70.27437 c 0.1713,-0.025 0.3548,-0.0214 0.5547,0.0161 1,0.3 1.7011,1.79926 2.6011,2.69926 2.9,3.1 5.9995,5.79883 9.7997,7.5988 1.9999,0.90001 2.7992,2.3009 3.0992,4.4009 1.1001,6.89999 2.3006,13.90002 3.4046,20.79936 2.3997,15.00006 -6.7323,-41.05446 -4.3317,-26.05456 0.9,5.50001 1.9021,11.00097 2.5017,16.60103 2.1,17.8 -3.8013,32.79934 -16.6012,44.99932 -8.4,8.00001 -18.5986,12.10068 -29.9986,13.80068 -7.4,1.1 -14.8006,2.4984 -22.2006,3.59835 -2.9999,0.50017 -6.1011,0.59998 -9.1011,0.89997 -25.2999,0 -47.8,-18.599 -52.0001,-44.099 -2.8974,-17.70043 5.9326,35.75387 3.0323,18.05392 -1.8003,-10.79995 -3.6015,-21.69855 -5.4009,-32.59865 -3e-4,-0.19994 -0.1,-0.30021 -0.1002,-0.50015 0.1,-1.9 -1.0998,-3.7 2e-4,-5.5 1.8,0.2 3.2,1.2989 4.8,1.9989 14.8,6.5 30.2001,9.20004 46.3002,7.50003 24.4999,-2.49998 44.8002,-13.19961 61.1002,-31.5996 0.7874,-0.875 1.3454,-2.43895 2.5445,-2.61532 z m 160.624,-23.07648 c 0.083,-0.0242 0.1702,-0.035 0.2605,-0.0288 0.1203,0.008 0.2449,0.0445 0.3698,0.11956 l 3.0008,1.50177 c 10.2,5.6 21.1005,9.09813 32.7005,10.29813 25.1,2.5 47.8993,-3.69809 67.8994,-19.2981 l 2.7,-2.10047 c 0.7,-0.4 1.3006,-0.30146 1.5006,0.4985 0.2001,0.9 0.3994,1.9013 0.5991,2.80135 2.3997,14.40005 4.6979,28.69969 6.9993,43.09947 2.1001,12.69998 -7.5308,-45.55408 -5.4305,-32.75413 0.6,3.3 0.8005,6.59953 0.9007,9.99951 0.3999,23.60002 -16.7008,46.99998 -42.9008,51.79999 -10.3,1.90001 -20.6982,3.901 -31.1981,4.90099 -24.6,2.4 -48.101,-13.80002 -55.0011,-37.90001 -1.2999,-4.4 -1.9001,-8.80061 -2.6001,-13.20062 -3.5997,-21.70004 4.5307,27.55478 1.0312,5.75471 4e-4,-0.40006 -0.1005,-0.70081 -0.101,-1.00074 -0.1,-1.6 -0.7001,-3.29878 -0.3001,-4.69878 0.5001,-1.50001 2.6012,-1.70093 3.9012,-2.50092 5.7,-3.40001 10.2002,-8.00052 13.5002,-13.90051 0.5,-0.89999 0.9994,-1.99998 1.5994,-2.89998 0.1125,-0.22499 0.32,-0.41834 0.5688,-0.49091 z"  /><path data-button="left_stick" inkscape:connector-curvature="0" id="path155-7" d="m 958.52991,471.80838 c -0.1337,10.43141 -8.7597,18.65618 -19.3249,18.52244 -8.8934,-0.13373 -18.5224,-7.08801 -18.3887,-19.12425 0.1338,-10.23081 8.0242,-18.65618 18.9905,-18.52245 11.9026,0.13374 18.9237,9.76274 18.7231,19.12426 z" class="st1" /><path data-button="right_bumper" sodipodi:nodetypes="ccccccc" class="st4" d="m 1103.5,272.7 c -2.8,0.1 -5.5,0.2 -8.2,0.7 -8.8,1.5 -17.7,2.7 -26.5,4.3 -13.2318,2.39218 -23.7811,8.47272 -31.6897,18.07452 17.6279,-5.01741 34.0063,-12.93148 53.0125,-14.75341 15.655,-4.5304 29.3137,-0.0603 43.6264,1.46149 -8.3983,-6.01363 -18.5122,-9.21284 -30.2492,-9.7826 z" id="path5612" inkscape:connector-curvature="0" style="fill:#f6d6d6;fill-opacity:1" /><path data-button="left_bumper" sodipodi:nodetypes="ccccccc" class="st4" d="m 806.11682,321.0246 c 2.68575,-0.79797 5.27672,-1.56404 7.99523,-1.951 8.81898,-1.38405 17.63709,-3.08433 26.48795,-4.3736 13.30394,-1.95145 25.24137,0.44824 35.79863,7.02736 -18.30763,0.86488 -36.35454,-1.41412 -54.94969,2.91892 -16.28242,0.69743 -27.80303,9.28914 -40.88355,15.29492 6.04263,-8.37746 14.60865,-14.63439 25.55143,-18.9166 z" id="path5612-2" inkscape:connector-curvature="0" style="fill:#f6d6d6;fill-opacity:1" /></g></g></svg>`

                    parent.innerHTML = svgSrc;

                    var svg = parent.children[0];

                    svg.style.width = "100%";
                    svg.style.maxHeight = "100%";

                    var buttons = {};

                    var buttonElems = svg.querySelectorAll("[data-button]");

                    for (var i = 0; i < buttonElems.length; i++) {
                        buttons[buttonElems[i].getAttribute("data-button")] = buttonElems[i];
                    }

                    state.buttons = buttons;

                },
                reset: function (parent, state) {
                    var buttons = Object.values(state.buttons);
                    for (var i = 0; i < buttons.length; i++) {
                        buttons[i].style.fill = "var(--widget-inner-background-color)";
                    }
                },
                ondata: function (data, parent, state) {
                    if (data.gamepad2) {

                        var entries = Object.entries(state.buttons);
                        for (var i = 0; i < entries.length; i++) {
                            if (data.gamepad2[entries[i][0]]) {
                                entries[i][1].style.fill = "var(--widget-text-color)";
                            } else {
                                entries[i][1].style.fill = "var(--widget-inner-background-color)";
                            }

                        }

                        state.buttons.right_stick.style.transform = `translate(${data.gamepad2.right_stick_x * 15}px, ${data.gamepad2.right_stick_y * 10}px)`;
                        state.buttons.right_stick.style.fill = "var(--widget-text-color)";

                        state.buttons.left_stick.style.transform = `translate(${data.gamepad2.left_stick_x * 15}px, ${data.gamepad2.left_stick_y * 10}px)`;
                        state.buttons.left_stick.style.fill = "var(--widget-text-color)";
                    }
                }
            }
        }

        window.addEventListener("load", function () {

            document.body.style.setProperty("--grid-size", gridSize + "px");

            var boxTotal = Math.ceil((window.innerWidth / gridSize) * (window.innerHeight / gridSize));

            var draggedWidget = undefined;

            var gridBackground = document.getElementById("grid-background");

            widgetsParent = document.getElementById("grid-widgets");

            for (var i = 0; i < boxTotal; i++) {
                gridBackground.appendChild(document.createElement("span"))
            }

            document.addEventListener("dragstart", function (e) {
                e.preventDefault();
            });

            var downX, downY, dragging, dragShadow;
            document.addEventListener("mousedown", mouseDownListener);
            document.addEventListener("touchstart", function (event) {

                if (event.touches.length != 1) return;

                mouseX = Math.floor((event.touches[0].clientX) / gridSize);
                mouseY = Math.floor(event.touches[0].clientY / gridSize);

                mouseDownListener();
            });
            function mouseDownListener(event) {
                if (draggedWidget == undefined) {
                    downX = mouseX, downY = mouseY;
                    dragging = true;
                }
            }
            document.addEventListener("mousemove", mouseMoveListener);
            document.addEventListener("touchmove", function (event) {
                mouseX = Math.floor((event.touches[0].clientX) / gridSize);
                mouseY = Math.floor(event.touches[0].clientY / gridSize);

                mouseMoveListener();
            });
            function mouseMoveListener(event) {
                if (dragging) {
                    event.preventDefault();
                    if (!dragShadow) dragShadow = makeDragShadow();

                    var x = Math.min(mouseX, downX) + 1;
                    var y = Math.min(mouseY, downY) + 1;
                    var width = Math.max(Math.abs(mouseX - downX) + 1, 0);
                    var height = Math.max(Math.abs(mouseY - downY) + 1, 0);

                    dragShadow.style.gridColumn = (x) + " / " + (x + width);
                    dragShadow.style.gridRow = (y) + " / " + (y + height);
                }
            }
            document.addEventListener("mouseup", mouseUpListener);
            document.addEventListener("touchend", mouseUpListener);
            function mouseUpListener() {
                if (dragShadow && dragShadow.parentElement) {
                    dragShadow.parentElement.removeChild(dragShadow);
                    dragShadow = undefined;
                }
                if (dragging) {
                    var x = Math.min(mouseX, downX) + 1;
                    var y = Math.min(mouseY, downY) + 1;
                    var width = Math.max(Math.abs(mouseX - downX) + 1, 0);
                    var height = Math.max(Math.abs(mouseY - downY) + 1, 0);

                    createWidget(x, y, width, height);
                }
                dragging = false;
                draggedWidget = undefined;
            }

            startDataRequest();
            recoverSavedItems();
        });

        window.addEventListener("mousemove", function (event) {
            mouseX = Math.floor((event.clientX) / gridSize);
            mouseY = Math.floor(event.clientY / gridSize);
        });
        window.addEventListener("touchmove", function (event) {
            mouseX = Math.floor((event.touches[0].clientX) / gridSize);
            mouseY = Math.floor(event.touches[0].clientY / gridSize);
        });

        var saveItemDatabase = null, userDeniedStorage = false;

        function recoverSavedItems() {
            idbPolyfill();
            if (userDeniedStorage) return false;
            if (saveItemDatabase == null) return acquireItemDatabase(recoverSavedItems);

            var transaction = saveItemDatabase.transaction(["widgets"], "readwrite");
            var objectStore = transaction.objectStore("widgets");
            var request = objectStore.getAll();

            request.onsuccess = function (e) {
                var vals = e.target.result;
                for (var i = 0; i < vals.length; i++) {
                    var val = vals[i];
                    var newWidg = createWidget(val.box.x, val.box.y, val.box.width, val.box.height, val.id);
                    newWidg.type = val.type;
                    newWidg.config = val.config;
                    newWidg.state = {};

                    widgetTypes[newWidg.type].init(newWidg.content, newWidg.state, newWidg.config, newWidg.box);
                }
            }
        }

        function deleteWidget(id) {
            var widget = widgetsReg[id];
            var widgetParent = widget.widget;
            if (widgetParent && widgetParent.parentElement) {
                widgetParent.parentElement.removeChild(widgetParent);
            }
            if (widgetTypes[widget.type].onbeforedelete) widgetTypes[widget.type].onbeforedelete(widgetParent, widget.state)
            delete widgetsReg[id];

            idbPolyfill();
            if (userDeniedStorage) return false;
            if (saveItemDatabase == null) return acquireItemDatabase(function () { deleteWidget(id); });

            var transaction = saveItemDatabase.transaction(["widgets"], "readwrite");
            var objectStore = transaction.objectStore("widgets");

            objectStore.delete(id);
        }
        function saveItemChanges(widget) {
            idbPolyfill();
            if (userDeniedStorage) return false;
            if (saveItemDatabase == null) return acquireItemDatabase(function () { saveItemChanges(widget); });

            var transaction = saveItemDatabase.transaction(["widgets"], "readwrite");
            var objectStore = transaction.objectStore("widgets");

            var clonable = {
                id: widget.id,
                type: widget.type,
                config: widget.config,
                box: widget.box
            }
            objectStore.put(clonable, widget.id);
        }
        function acquireItemDatabase(cb) {
            var request = window.indexedDB.open("savedData", 1);
            request.onerror = function (event) {
                userDeniedStorage = true;

                if (cb) cb();
            };
            request.onsuccess = function (event) {
                saveItemDatabase = event.target.result;

                if (cb) cb();
            };
            request.onupgradeneeded = function (event) {
                // Save the IDBDatabase interface
                var db = event.target.result;

                // Create an objectStore for this database
                var objectStore = db.createObjectStore("widgets", {});
            };

        }

        function idbPolyfill() {
            window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
            window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction || { READ_WRITE: "readwrite" }; // This line should only be needed if it is needed to support the object's constants for older browsers
            window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange;
        }

        function createWidget(x, y, width, height, recoveredId) {
            var id = Date.now() + ":" + (widgetsReg.__counter || 0);
            widgetsReg.__counter = (widgetsReg.__counter || 0) + 1;

            if (recoveredId) id = recoveredId;

            var widget = document.createElement("div");
            widget.classList.add("widget");

            widget.style.gridColumn = (x) + " / " + (x + width);
            widget.style.gridRow = (y) + " / " + (y + height);

            var widgetInner = document.createElement("div");
            widgetInner.classList.add("widget--inner");

            var selfWidget = {
                id: id,
                widget: widget,
                widgetInner: widgetInner,
                toolbar: createWidgetToolbar(id, widgetInner),
                content: createWidgetContent(id, widgetInner),
                type: "none",
                state: {},
                config: {},
                box: {
                    x: x,
                    y: y,
                    height: height,
                    width: width
                }
            };

            widgetsReg[id] = selfWidget;

            (function dragging() {
                var pointerEvents = ["click", "dblclick", "mousedown", "touchstart"];

                for (var i = 0; i < pointerEvents.length; i++) {
                    widget.addEventListener(pointerEvents[i], function (e) {
                        e.stopPropagation();
                    });
                }

                var downX, downY, dragging, dragShadow;

                widget.addEventListener("contextmenu", function (event) {
                    event.preventDefault();
                    openSidebar(id);
                });

                widget.addEventListener("mousedown", widgetMouseDownListener);
                function widgetMouseDownListener(event) {
                    if (event.ctrlKey) {
                        event.preventDefault();
                        var widgetCopy = createWidget(x, y, width, height);

                        widgetCopy.type = selfWidget.type;
                        widgetCopy.config = JSON.parse(JSON.stringify(selfWidget.config));
                        widgetCopy.state = {};

                        widgetTypes[widgetCopy.type].init(widgetCopy.content, widgetCopy.state, widgetCopy.config, widgetCopy.box);
                    }
                    downX = mouseX, downY = mouseY;
                    dragging = true;
                    draggedWidget = widget;
                }
                document.addEventListener("mousemove", function (event) {
                    if (dragging) {
                        event.preventDefault();
                        if (!dragShadow) dragShadow = makeDragShadow();

                        var shadowX = x + (mouseX - downX);
                        var shadowY = y + (mouseY - downY);

                        dragShadow.style.gridColumn = shadowX + " / " + (shadowX + width);
                        dragShadow.style.gridRow = shadowY + " / " + (shadowY + height);
                    }
                });
                function stopDrag(event) {
                    if (dragShadow && dragShadow.parentElement) {
                        dragShadow.parentElement.removeChild(dragShadow);
                        dragShadow = undefined;
                    }

                    if (dragging && (mouseX - downX != 0 || mouseY - downY != 0)) {
                        x += (mouseX - downX);
                        y += (mouseY - downY);

                        y = Math.max(y, 0);
                        x = Math.max(x, 0);

                        widget.style.gridColumn = (x) + " / " + (x + width);
                        widget.style.gridRow = (y) + " / " + (y + height);

                        selfWidget.box = {
                            x: x,
                            y: y,
                            height: height,
                            width: width
                        };
                        saveItemChanges(selfWidget);
                    }
                    dragging = false;
                }
                document.addEventListener("mouseup", stopDrag);
                widget.addEventListener("mouseup", stopDrag);

                widget.addEventListener("touchend", stopDrag);
                document.addEventListener("touchend", stopDrag);
            })();

            widget.appendChild(widgetInner);

            widgetsParent.appendChild(widget)

            return selfWidget;
        }
        function createWidgetToolbar(id, parent) {
            var toolbar = document.createElement("nav");
            toolbar.classList.add("widget--toolbar");

            var settingsButton = document.createElement("button");
            settingsButton.setAttribute("aria-label", "Settings");
            settingsButton.classList.add("widget--toolbar--settings-button")
            settingsButton.addEventListener("click", function () {
                openSidebar(id);
            });
            toolbar.appendChild(settingsButton);

            var deleteButton = document.createElement("button");
            deleteButton.setAttribute("aria-label", "Remove Widget");
            deleteButton.classList.add("widget--toolbar--delete-button")
            deleteButton.addEventListener("click", function () {
                deleteWidget(id);
            });

            toolbar.appendChild(deleteButton);
            parent.appendChild(toolbar);

            return toolbar;
        }
        function createWidgetContent(id, parent) {
            var content = document.createElement("div");
            content.classList.add("widget--content");
            parent.appendChild(content);
            return content;
        }
        function makeDragShadow() {
            var shadow = document.createElement("div");
            shadow.classList.add("drag-shadow");
            document.getElementById("grid-ui").appendChild(shadow);
            return shadow;
        }

        var openSidebar, closeSidebar;
        (function sidebar() {
            var sidebarInited = false, sidebarFocusedWidgetId, sidebarOpen;
            openSidebar = function openSidebar(id) {
                if (!sidebarInited) initSidebar();
                if (sidebarOpen) closeSidebar();

                sidebarFocusedWidgetId = id;

                var sidebarParent = document.getElementById("config-sidebar-parent");
                var sidebar = document.getElementById("config-sidebar");

                sidebar.innerHTML = "";
                populateSidebar(id, sidebar);

                sidebarParent.style.display = "block";
                sidebar.setAttribute("open", "true");
                sidebar.focus();

                sidebarOpen = true;
            }
            closeSidebar = function closeSidebar() {
                if (!sidebarInited) initSidebar();

                if (!sidebarOpen) return false;

                var sidebarParent = document.getElementById("config-sidebar-parent");
                var sidebar = document.getElementById("config-sidebar");
                sidebarParent.style.display = "none";
                sidebar.removeAttribute("open");

                sidebarOpen = false;

                if (sidebarFocusedWidgetId && widgetsReg[sidebarFocusedWidgetId]) widgetsReg[sidebarFocusedWidgetId].widget.focus();
                sidebarFocusedWidgetId = undefined;
            }
            function initSidebar() {
                var sidebarParent = document.getElementById("config-sidebar-parent");

                var pointerEvents = ["click", "dblclick", "mousedown", "touchstart"];

                for (var i = 0; i < pointerEvents.length; i++) {
                    sidebarParent.addEventListener(pointerEvents[i], function (e) {
                        e.stopPropagation();
                    });
                }

                sidebarParent.addEventListener("click", function (e) {
                    if (e.target == sidebarParent) closeSidebar();
                });

                document.addEventListener("keyup", function escapeListener(e) {
                    if (e.which == 27 || e.key == "Escape" || e.code == "Escape") closeSidebar();
                });

                sidebarInited = true;

            }

            function populateSidebar(id, sidebar) {

                var typeSelect = document.createElement("select");
                var settings = document.createElement("fieldset");
                settings.classList.add("sidebar--config-fields");

                var keys = Object.keys(widgetTypes).sort();
                for (var i = 0; i < keys.length; i++) {
                    var opt = document.createElement("option");
                    if (keys[i] == widgetsReg[id].type) opt.selected = true;
                    opt.textContent = keys[i];
                    typeSelect.appendChild(opt);
                }
                typeSelect.addEventListener("change", function () {
                    widgetsReg[id].type = keys[typeSelect.selectedIndex] || "none";
                    widgetsReg[id].state = {};
                    widgetsReg[id].config = {};
                    widgetsReg[id].content.innerHTML = "";
                    widgetsReg[id].content.className = "widget--content";
                    widgetTypes[widgetsReg[id].type].init(widgetsReg[id].content, widgetsReg[id].state, widgetsReg[id].config, widgetsReg[id].box);

                    populateSidebarConfig(id, settings);
                    saveItemChanges(widgetsReg[id]);
                });
                var label = document.createElement("label");
                label.textContent = "Widget Type: ";
                label.appendChild(typeSelect)
                sidebar.appendChild(label);

                sidebar.appendChild(document.createElement("hr"));


                populateSidebarConfig(id, settings);
                sidebar.appendChild(settings);
            }

            function populateSidebarConfig(id, sidebar) {
                var type = widgetTypes[widgetsReg[id].type];
                var config = type.config || [];

                if (config.length == 0) sidebar.classList.add("no-settings");
                else sidebar.classList.remove("no-settings");

                sidebar.innerHTML = "";

                for (var i = 0; i < config.length; i++) {
                    var configOption = config[i]
                    var lbl = document.createElement("label");
                    lbl.textContent = configOption.name + ": ";

                    if (configOption.type == "select") {
                        if (configOption.value == "field") {
                            lbl.appendChild(
                                createSelectControl(widgetsReg[id].config, configOption.name, fields, widgetsReg[id])
                            );
                        } else {
                            lbl.appendChild(
                                createSelectControl(widgetsReg[id].config, configOption.name, configOption.value, widgetsReg[id])
                            );
                        }
                    } else if (configOption.type == "number") {

                        lbl.appendChild(
                            createNumberControl(widgetsReg[id].config, configOption.name, configOption.default, widgetsReg[id])
                        );
                    } else if (configOption.type == "text") {

                        lbl.appendChild(
                            createTextControl(widgetsReg[id].config, configOption.name, configOption.default, widgetsReg[id])
                        );
                    }

                    sidebar.appendChild(lbl);
                }
            }
        })();

        function createSelectControl(config, key, options, widget) {
            var select = document.createElement("select");

            if (config[key] === undefined) config[key] = options[0];

            options = options.map(x => x + "").sort();

            for (var i = 0; i < options.length; i++) {
                var opt = document.createElement("option");
                if (config[key] === options[i]) opt.setAttribute("selected", "true");
                opt.textContent = options[i];
                select.appendChild(opt);
            }
            select.addEventListener("change", function () {
                config[key] = options[select.selectedIndex];
                saveItemChanges(widget);
            });
            return select;
        }

        function createNumberControl(config, key, defaultValue, widget) {
            if (config[key] === undefined) {
                config[key] = defaultValue || 0;
            }
            var input = document.createElement("input");
            input.type = "number";
            input.value = config[key];
            input.addEventListener("change", function () {
                config[key] = input.valueAsNumber;
                saveItemChanges(widget);
            });

            return input;
        }

        function createTextControl(config, key, defaultValue, widget) {
            if (config[key] === undefined) {
                config[key] = defaultValue || "";
            }
            var input = document.createElement("input");
            input.value = config[key];
            input.addEventListener("change", function () {
                config[key] = input.value;
                saveItemChanges(widget);
            });

            return input;
        }

        function sendCommand() {
            var argsArray = Array.from(arguments);

            var cb = () => 0;

            if (typeof argsArray[argsArray.length - 1] == "function") cb = argsArray.pop();

            var body = argsArray.join(",");

            var xhr = new XMLHttpRequest();

            xhr.open("GET", "/command?command=" + encodeURIComponent(body));
            xhr.onload = cb;
            xhr.send();
        }

        var dataXhr = null;
        function startDataRequest() {
            if (dataXhr != null) return false;

            var xhr = new XMLHttpRequest();
            dataXhr = xhr;

            xhr.open("GET", "/stream");

            var currentChunkGlob = "";
            var lastIndex = -1;
            xhr.addEventListener("progress", function (event) {
                hideErrorBanner();
                var currentIndex = xhr.responseText.length;
                if (lastIndex == currentIndex) return; // No new data
                var streamData = xhr.responseText.substring(lastIndex, currentIndex);

                currentChunkGlob += streamData;

                var validChunkGlob = "";
                //must be a valid chunk!!
                if (currentChunkGlob.indexOf("\n") != -1) {
                    validChunkGlob = currentChunkGlob.substring(0, currentChunkGlob.lastIndexOf("\n"));
                    currentChunkGlob = currentChunkGlob.substring(currentChunkGlob.lastIndexOf("\n"));
                } else {
                    return;
                }

                var streamChunks = validChunkGlob.split("\n");

                for (var i = 0; i < streamChunks.length; i++) {
                    if (streamChunks[i].startsWith("{")) processData(streamChunks[i]);
                    //else console.log("Control code: " + streamChunks[i]);
                }

                lastIndex = currentIndex;
            });

            xhr.addEventListener("error", function () {
                dataXhr = null;
                showErrorBanner();
            });

            xhr.send();

            //abort & restart after 30s
            setTimeout(function () {
                xhr.abort();
                dataXhr = null;
                startDataRequest();
            }, 30000);
        }

        var shouldDispatchData = true;
        function processData(data) {
            var dataObject = {};
            try {
                dataObject = JSON.parse(data);
            } catch (e) {
                console.error(data);
                console.error(e);
            }
            //if it's a streamid setter, do that first
            if(dataObject.streamID) {
                configGlobals.streamID = dataObject.streamID;
                return;
            }

            //make autoauto variables normal, accessible fields. It's just easier.
            if(dataObject.fields) Object.assign(dataObject.fields, dataObject.autoautoVariables || {});

            if (shouldDispatchData) dispatchData(dataObject);
        }

        function reportStartRecordPlayback() {
            shouldDispatchData = false;
        }
        function reportStopRecordPlayback() {
            shouldDispatchData = true;
        }
        function resetWidgets() {
            var w = Object.values(widgetsReg);
            for (var i = 0; i < w.length; i++) {
                if (widgetTypes[w[i].type]) widgetTypes[w[i].type].reset(w[i].widget, w[i].state);
            }
        }


        function dispatchData(dataObject) {
            if (dataObject.fields !== undefined) fields = Object.keys(dataObject.fields);
            var widgets = Object.values(widgetsReg);
            for (var i = 0; i < widgets.length; i++) {
                //skip `__continue`
                if (typeof widgets[i] == "number") continue;

                try {
                    widgetTypes[widgets[i].type].ondata(dataObject, widgets[i].content, widgets[i].state, widgets[i].config);
                } catch (e) {
                    console.error(e);
                    console.error(widgets[i]);
                }
            }
        }

        function flattenObj(obj) {
            var res = {};
            for (var i in obj) {
                if (typeof obj[i] === "object") {
                    var flattenedProperty = flattenObj(obj[i]);
                    for (var j in flattenedProperty) {
                        res[i + '.' + j] = flattenedProperty[j];
                    }
                } else {
                    res[i] = obj[i];
                }
            }
            return res;
        }
        function downloadURL(uri, name) {
            var link = document.createElement("a");
            link.download = name;
            link.href = uri;
            link.click();
        }
        function csvEscape(val) {
            if(typeof val == "string") return '"' + val.replace('"', '""') + '"';
            else return val;
        }
        function drawLine(datapoints, box, xScale, isFilled) {
            var xRightEdge = 0;

            //find top point & bottom point
            var max = datapoints[0].y;
            var min = datapoints[0].y;
            for (var i = 0; i < datapoints.length; i++) {
                max = Math.max(max, datapoints[i].y);
                min = Math.min(min, datapoints[i].y);

                xRightEdge = Math.max(xRightEdge, datapoints[i].x);
            }

            var range = max - min;

            var path = "";

            for (var i = 0; i < datapoints.length; i++) {
                var point = datapoints[i];

                var x = 1 - ((xRightEdge - point.x) / xScale);
                var y = (range - (point.y - min)) / range;

                //initialization
                if (i == 0) path += "M" + (x * box.width) + "," + (y * box.height);

                path += "L" + (x * box.width) + "," + (y * box.height);
            }
            return path;
        }

        function sliceData(data, leftEdge) {
            var firstDisplayedDatapointIndex = 0;
            //find the first displayed datapoint. If there's not enough data to cover the graph, it'll select everything.
            for (var i = data.length - 1; i >= 0; i--) {
                if (data[i].x < leftEdge) {
                    firstDisplayedDatapointIndex = i + 1;
                    break;
                }
            }
            return data.slice(firstDisplayedDatapointIndex);
        }

        var errorBanner = document.createElement("div");
        (function () {
            errorBanner.style.display = "none";
            errorBanner.textContent = "No live connection to robot-based server. Retrying connection currently."
            errorBanner.classList.add("error-banner");
            window.addEventListener("load", function () {
                document.body.appendChild(errorBanner);
            });
        })();
        function showErrorBanner() {
            errorBanner.style.display = "block";
        }
        function hideErrorBanner() {
            errorBanner.style.display = "none";
        }

    </script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            background: var(--background-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body.dark-theme {
            --widget-text-color: #EFF9FB;
            --widget-background-color: #1B1D22;
            --background-color: #2A2D34;
            --grid-color: #EFF9FB;
            --widget-inner-background-color: #24272D;
            --close-widget-color: #C23838;
            --widget-settings-color: #0092CC;
            --sidebar-lightbox: #1B1D22cc;
            --data-green: #10BC8B;
            --data-red: #e72f2f;
            --graph-label: #3E4247;
        }

        body.light-theme {
            --widget-text-color: #1e1f1f;
            --widget-background-color: #98A0AE;
            --background-color: #B0B4BF;
            --grid-color: #090A0B;
            --widget-inner-background-color: #d4d4d4;
            --close-widget-color: #B22E2E;
            --widget-settings-color: #0075A3;
            --sidebar-lightbox: #98A0AEcc;
            --data-green: #007a58;
            --data-red: #a50909;
            --graph-label: #a8a8a8;
        }

        .error-banner {
            background-color: var(--close-widget-color);
            color: var(--widget-text-color);
            position: fixed;
            bottom: 0;
            left: 0;
            text-align: center;
            opacity: 0.9;
            width: 100%;
            padding: 0.25em 1em;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, var(--grid-size));
            grid-template-rows: repeat(auto-fill, var(--grid-size));
            grid-gap: 0;
            gap: 0;

            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100vw;
            height: 100vh;
        }

        #grid-background span {
            display: block;
            width: var(--grid-size);
            height: var(--grid-size);
            position: relative;
        }

        #grid-background span::before {
            width: 2px;
            height: 2px;
            background: var(--grid-color);
            content: "";
            display: inline-block;
            position: absolute;
            top: -1px;
            left: -1px;
        }

        #grid-background span::after {
            width: 2px;
            height: 2px;
            background: var(--grid-color);
            content: "";
            display: inline-block;
            position: absolute;
            bottom: -1px;
            right: -1px;
        }

        .widget {
            background: var(--widget-background-color);
            box-shadow: 0 0 0.5px 1px var(--background-color);
            padding: 5px;
        }

        .widget--inner {
            background: var(--widget-inner-background-color);
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .drag-shadow {
            background: var(--widget-background-color);
            opacity: 0.85;
            border-radius: 50px;
        }

        #grid-ui {
            pointer-events: none;
        }

        .widget:hover .widget--toolbar {
            min-height: 2em;
            padding: 0.125em;
            background-color: var(--widget-background-color);
            opacity: 1;

        }

        .widget--toolbar {
            height: 0em;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.125s;
            gap: 0.2em;
            justify-content: flex-end;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            flex-shrink: 0;
        }

        .widget--toolbar select {
            all: unset;
            color: var(--widget-text-color);
            background: inherit;
            border: 0;
            cursor: pointer;
            user-select: none;
        }

        .widget--toolbar--delete-button {
            all: unset;

            display: inline-block;

            width: 1em;
            height: 1em;


            background: var(--close-widget-color);
            border-radius: 100%;

            cursor: pointer;
            user-select: none;
        }

        .widget--toolbar--settings-button {
            all: unset;

            display: inline-block;

            width: 1em;
            height: 1em;


            background: var(--widget-settings-color);
            border-radius: 100%;

            cursor: pointer;
            user-select: none;
        }

        .widget--content {
            flex-grow: 1;
            color: var(--widget-text-color);
            overflow: auto;
            padding: 0.5em;
            display: flex;
            flex-direction: column;
        }

        .widget--content h3 {
            font-size: 2em;
            margin-top: 0;
            margin-bottom: 0.125em;
        }

        .widget--content.nopadding {
            padding: 0
        }

        .widget--content.nooverflow {
            overflow: hidden
        }

        .widget--content pre {
            margin: 0;
        }

        .widget--content.center p {
            font-weight: bold;
            word-wrap: break-word;
            max-width: 100%;
        }

        .widget--content.center {
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        #config-sidebar {
            color: var(--widget-text-color);
            position: absolute;
            top: 0;
            height: 100vh;
            width: calc(3 * var(--grid-size));
            min-width: 2in;
            max-width: 80vw;
            background: var(--widget-inner-background-color);
            display: none;
            opacity: 0;
            transition: opacity 0.25s;
            padding: 1em;
            border-right: 0.25em solid var(--widget-background-color);

            flex-direction: column;
        }

        #config-sidebar hr {
            border: 0;
            border-top: 1px solid var(--widget-text-color);
        }

        #config-sidebar[open] {
            display: flex;
            opacity: 1;
        }

        #config-sidebar[data-side=left] {
            left: 0;
        }

        #config-sidebar[data-side=right] {
            left: 0;
        }

        #config-sidebar-parent {
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            width: 100vw;
            height: 100vh;

            display: none;

            background: var(--sidebar-lightbox);
        }

        .sidebar--config-fields {
            border: 2px solid var(--widget-background-color);
            flex-grow: 1;
        }

        .sidebar--config-fields label {
            display: block;
        }

        .sidebar--config-fields.no-settings {
            background: var(--widget-background-color);
        }

        .widget--line-chart {
            width: 100%;
            height: 100%;
        }

        .widget--line-chart--fill-line {
            fill: url(#line-graph-fill-gradient);
        }

        .widget--line-chart--stroke-line {
            stroke: var(--data-green);
            stroke-width: 0.125em;
            stroke-linejoin: round;
            fill: transparent;
            stroke-linecap: round;
        }

        .widget--line-chart--caption-line {
            stroke: var(--graph-label);
            stroke-width: 0.25em;
            stroke-linecap: round;
        }

        .widget--line-chart--caption {
            fill: var(--graph-label);
            font: inherit;
            font-size: 1.85em;
        }

        #line-graph-fill-gradient-color {
            stop-color: var(--data-green);
        }

        .st1 {
            fill: var(--widget-text-color);
        }

        .widget--autoauto-state-layout--list {
            display: flex;
            margin: 0;
            padding: 0;
            list-style-type: none;
            flex-grow: 1;
        }

        .widget--autoauto-state-layout--list>li {
            margin: 0 1em;
            display: flex;
            flex-direction: column-reverse;
            text-align: center;
        }

        .widget--autoauto-state-layout--list h2 {
            font-size: 0.85em;
            letter-spacing: -0.001ch;
            margin-top: 0.5em;
            padding-top: 0.5em;
            border-top: 1px solid var(--widget-text-color);
            /*! text-transform: uppercase; */
            font-weight: 600;
        }

        .widget--autoauto-state-layout--list ol {
            list-style-type: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column-reverse;
        }

        .widget--autoauto-state-layout--list ol li {
            width: min-content;
            margin: 2px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: 2px solid var(--widget-text-color);
            color: inherit;
            font-size: 1.5em;
            font-family: monospace;
            font-weight: bold;
            border-radius: 100%;
            width: 2em;
            height: 2em;
            display: flex;
            align-items: center;
            justify-content: center;
            align-content: center;
            text-align: center;
        }

        .widget--autoauto-state-layout--list ol li button {
            background: none;
            color: inherit;
            font: inherit;
            display: inline;
            border: none;
            text-align: center;
        }

        .widget--autoauto-state-layout--list ol li.selected {
            background: var(--data-green);
            color: var(--background-color);
            border: 2px solid transparent;
        }

        .widget--record {
            display: flex;
            padding: 0.5em;
            flex-wrap: wrap;
            flex-direction: row;
        }

        .widget--record div[role=slider] {
            flex-grow: 1;
            min-height: 2.5em;
            background: var(--widget-background-color);
            position: relative;
        }

        .widget--record div[role=slider] svg {
            position: absolute;
            bottom: 0;
        }

        .widget--record nav {
            padding-bottom: 0.5em;
            max-width: max-content;
            margin: auto 0;
        }

        .widget--record nav button {
            border: 0;
            font: inherit;
            padding: 0.75em;
            border-radius: 100%;
            margin-right: 0.25em;
            background-color: var(--widget-background-color);
        }

        .widget--record nav button[red-icon=true] svg path {
            fill: var(--data-red);
        }

        .widget--record nav button[greyed=true] svg path {
            opacity: 0.5;
        }

        .widget--record nav button svg {
            width: 1.5em;
            height: 1.5em;
        }

        .widget--record nav button svg path {
            fill: var(--widget-text-color);
        }
    </style>
</head>

<body>
    <svg style="width:0;height:0;position:absolute;" aria-hidden="true" focusable="false">
        <linearGradient id="line-graph-fill-gradient" x2="0" y2="1">
            <stop offset="0%" stop-color="#447799" id="line-graph-fill-gradient-color" />
            <stop offset="100%" stop-color="#0000" id="line-graph-fill-bg-color" />
        </linearGradient>
    </svg>

    <div aria-hidden="true" class="grid" id="grid-background"></div>
    <div class="grid" id="grid-widgets"></div>
    <div aria-hidden="true" class="grid" id="grid-ui"></div>
    <div id="config-sidebar-parent">
        <sidebar id="config-sidebar" data-side="left"></sidebar>
    </div>
    <script>
        if (localStorage.getItem("theme") == "light") document.body.classList.add("dark-theme");
        else document.body.classList.add("dark-theme");
    </script>
</body>

</html>